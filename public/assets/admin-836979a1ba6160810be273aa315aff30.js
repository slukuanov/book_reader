!function(e,t){e.rails!==t&&e.error("jquery-ujs has already been loaded!");var n,i=e(document);e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with], a[data-disable]",buttonClickSelector:"button[data-remote]:not(form button), button[data-confirm]:not(form button)",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",disableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input[type=file]",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},refreshCSRFTokens:function(){var t=e("meta[name=csrf-token]").attr("content"),n=e("meta[name=csrf-param]").attr("content");e('form input[name="'+n+'"]').val(t)},fire:function(t,n,i){var o=e.Event(n);return t.trigger(o,i),o.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(i){var o,r,a,s,l,c,d,u;if(n.fire(i,"ajax:before")){if(s=i.data("cross-domain"),l=s===t?null:s,c=i.data("with-credentials")||null,d=i.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType,i.is("form")){o=i.attr("method"),r=i.attr("action"),a=i.serializeArray();var h=i.data("ujs:submit-button");h&&(a.push(h),i.data("ujs:submit-button",null))}else i.is(n.inputChangeSelector)?(o=i.data("method"),r=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):i.is(n.buttonClickSelector)?(o=i.data("method")||"get",r=i.data("url"),a=i.serialize(),i.data("params")&&(a=a+"&"+i.data("params"))):(o=i.data("method"),r=n.href(i),a=i.data("params")||null);return u={type:o||"GET",data:a,dataType:d,beforeSend:function(e,o){return o.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+o.accepts.script),n.fire(i,"ajax:beforeSend",[e,o])?void i.trigger("ajax:send",e):!1},success:function(e,t,n){i.trigger("ajax:success",[e,t,n])},complete:function(e,t){i.trigger("ajax:complete",[e,t])},error:function(e,t,n){i.trigger("ajax:error",[e,t,n])},crossDomain:l},c&&(u.xhrFields={withCredentials:c}),r&&(u.url=r),n.ajax(u)}return!1},handleMethod:function(i){var o=n.href(i),r=i.data("method"),a=i.attr("target"),s=e("meta[name=csrf-token]").attr("content"),l=e("meta[name=csrf-param]").attr("content"),c=e('<form method="post" action="'+o+'"></form>'),d='<input name="_method" value="'+r+'" type="hidden" />';l!==t&&s!==t&&(d+='<input name="'+l+'" value="'+s+'" type="hidden" />'),a&&c.attr("target",a),c.hide().append(d).appendTo("body"),c.submit()},formElements:function(t,n){return t.is("form")?e(t[0].elements).filter(n):t.find(n)},disableFormElements:function(t){n.formElements(t,n.disableSelector).each(function(){n.disableFormElement(e(this))})},disableFormElement:function(e){var n,i;n=e.is("button")?"html":"val",i=e.data("disable-with"),e.data("ujs:enable-with",e[n]()),i!==t&&e[n](i),e.prop("disabled",!0)},enableFormElements:function(t){n.formElements(t,n.enableSelector).each(function(){n.enableFormElement(e(this))})},enableFormElement:function(e){var t=e.is("button")?"html":"val";e.data("ujs:enable-with")&&e[t](e.data("ujs:enable-with")),e.prop("disabled",!1)},allowAction:function(e){var t,i=e.data("confirm"),o=!1;return i?(n.fire(e,"confirm")&&(o=n.confirm(i),t=n.fire(e,"confirm:complete",[o])),o&&t):!0},blankInputs:function(t,n,i){var o,r,a=e(),s=n||"input,textarea",l=t.find(s);return l.each(function(){if(o=e(this),r=o.is("input[type=checkbox],input[type=radio]")?o.is(":checked"):o.val(),!r==!i){if(o.is("input[type=radio]")&&l.filter('input[type=radio]:checked[name="'+o.attr("name")+'"]').length)return!0;a=a.add(o)}}),a.length?a:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},disableElement:function(e){var i=e.data("disable-with");e.data("ujs:enable-with",e.html()),i!==t&&e.html(i),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.removeData("ujs:enable-with")),e.unbind("click.railsDisable")}},n.fire(i,"rails:attachBindings")&&(e.ajaxPrefilter(function(e,t,i){e.crossDomain||n.CSRFProtection(i)}),e(window).on("pageshow.rails",function(){e(e.rails.enableSelector).each(function(){var t=e(this);t.data("ujs:enable-with")&&e.rails.enableFormElement(t)}),e(e.rails.linkDisableSelector).each(function(){var t=e(this);t.data("ujs:enable-with")&&e.rails.enableElement(t)})}),i.delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),i.delegate(n.buttonDisableSelector,"ajax:complete",function(){n.enableFormElement(e(this))}),i.delegate(n.linkClickSelector,"click.rails",function(i){var o=e(this),r=o.data("method"),a=o.data("params"),s=i.metaKey||i.ctrlKey;if(!n.allowAction(o))return n.stopEverything(i);if(!s&&o.is(n.linkDisableSelector)&&n.disableElement(o),o.data("remote")!==t){if(s&&(!r||"GET"===r)&&!a)return!0;var l=n.handleRemote(o);return l===!1?n.enableElement(o):l.fail(function(){n.enableElement(o)}),!1}return r?(n.handleMethod(o),!1):void 0}),i.delegate(n.buttonClickSelector,"click.rails",function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);i.is(n.buttonDisableSelector)&&n.disableFormElement(i);var o=n.handleRemote(i);return o===!1?n.enableFormElement(i):o.fail(function(){n.enableFormElement(i)}),!1}),i.delegate(n.inputChangeSelector,"change.rails",function(t){var i=e(this);return n.allowAction(i)?(n.handleRemote(i),!1):n.stopEverything(t)}),i.delegate(n.formSubmitSelector,"submit.rails",function(i){var o,r,a=e(this),s=a.data("remote")!==t;if(!n.allowAction(a))return n.stopEverything(i);if(a.attr("novalidate")==t&&(o=n.blankInputs(a,n.requiredInputSelector),o&&n.fire(a,"ajax:aborted:required",[o])))return n.stopEverything(i);if(s){if(r=n.nonBlankInputs(a,n.fileInputSelector)){setTimeout(function(){n.disableFormElements(a)},13);var l=n.fire(a,"ajax:aborted:file",[r]);return l||setTimeout(function(){n.enableFormElements(a)},13),l}return n.handleRemote(a),!1}setTimeout(function(){n.disableFormElements(a)},13)}),i.delegate(n.formInputClickSelector,"click.rails",function(t){var i=e(this);if(!n.allowAction(i))return n.stopEverything(t);var o=i.attr("name"),r=o?{name:o,value:i.val()}:null;i.closest("form").data("ujs:submit-button",r)}),i.delegate(n.formSubmitSelector,"ajax:send.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),i.delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))}),e(function(){n.refreshCSRFTokens()}))}(jQuery),function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,n,i,o,r,a;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),r=e.childNodes,a=[],i=0,o=r.length;o>i;i++)n=r[i],a.push(this.add_option(n,t,e.disabled));return a},e.prototype.add_option=function(e,t,n){return"OPTION"===e.nodeName.toUpperCase()?(""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:n===!0?n:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e}(),e.select_to_array=function(t){var n,i,o,r,a;for(i=new e,a=t.childNodes,o=0,r=a.length;r>o;o++)n=a[o],i.add_node(n);return i.parsed},this.SelectParser=e}.call(this),function(){var e,t;t=this,e=function(){function e(t,n){this.form_field=t,this.options=null!=n?n:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.result_add_option=function(e){var t,n;return e.dom_id=this.container_id+"_o_"+e.array_index,t=[],e.disabled||e.selected&&this.is_multiple||t.push("active-result"),!e.disabled||e.selected&&this.is_multiple||t.push("disabled-result"),e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),n=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+n+">"+e.html+"</li>"},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.choices_count=function(){var e,t,n,i;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,i=this.form_field.options,t=0,n=i.length;n>t;t++)e=i[t],e.selected&&(this.selected_option_count+=1);return this.selected_option_count},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,n;switch(t=null!=(n=e.which)?n:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,n;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",n=Math.floor(Math.random()*e.length),t=e.substring(n,n+1)},e.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},e.browser_is_supported=function(){var e;return"Microsoft Internet Explorer"===window.navigator.appName?null!==(e=document.documentMode)&&e>=8:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),t.AbstractChosen=e}.call(this),function(){var e,t,n,i,o={}.hasOwnProperty,r=function(e,t){function n(){this.constructor=e}for(var i in t)o.call(t,i)&&(e[i]=t[i]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};n=this,e=jQuery,e.fn.extend({chosen:function(n){return AbstractChosen.browser_is_supported()?this.each(function(){var i;return i=e(this),i.hasClass("chzn-done")?void 0:i.data("chosen",new t(this,n))}):this}}),t=function(t){function o(){return i=o.__super__.constructor.apply(this,arguments)}return r(o,t),o.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},o.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},o.prototype.set_up_html=function(){var t,n;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",t=["chzn-container"],t.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chzn-rtl"),n={id:this.container_id,"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.container=e("<div />",n),this.container.html(this.is_multiple?'<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop"><ul class="chzn-results"></ul></div>':'<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chzn-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},o.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){e.container_mousedown(t)}),this.container.mouseup(function(t){e.container_mouseup(t)}),this.container.mouseenter(function(t){e.mouse_enter(t)}),this.container.mouseleave(function(t){e.mouse_leave(t)}),this.search_results.mouseup(function(t){e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel DOMMouseScroll",function(t){e.search_results_mousewheel(t)}),this.form_field_jq.bind("liszt:updated",function(t){e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){e.container_mousedown(t)}),this.search_field.blur(function(t){e.input_blur(t)}),this.search_field.keyup(function(t){e.keyup_checker(t)}),this.search_field.keydown(function(t){e.keydown_checker(t)}),this.search_field.focus(function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.click(function(t){e.choices_click(t)}):this.container.click(function(e){e.preventDefault()})},o.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},o.prototype.container_mousedown=function(t){return this.is_disabled||(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chzn-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field())},o.prototype.container_mouseup=function(e){return"ABBR"!==e.target.nodeName||this.is_disabled?void 0:this.results_reset(e)},o.prototype.search_results_mousewheel=function(e){var t,n,i;return t=-(null!=(n=e.originalEvent)?n.wheelDelta:void 0)||(null!=(i=e.originialEvent)?i.detail:void 0),null!=t?(e.preventDefault(),"DOMMouseScroll"===e.type&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},o.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},o.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},o.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},o.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},o.prototype.results_build=function(){var e,t,i,o,r;for(this.parsing=!0,this.selected_option_count=null,this.results_data=n.SelectParser.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field.prop("readonly",!0),this.container.addClass("chzn-container-single-nosearch")):(this.search_field.prop("readonly",!1),this.container.removeClass("chzn-container-single-nosearch"))),e="",r=this.results_data,i=0,o=r.length;o>i;i++)t=r[i],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},o.prototype.result_add_group=function(t){return t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>"},o.prototype.result_do_highlight=function(e){var t,n,i,o,r;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),i=parseInt(this.search_results.css("maxHeight"),10),r=this.search_results.scrollTop(),o=i+r,n=this.result_highlight.position().top+this.search_results.scrollTop(),t=n+this.result_highlight.outerHeight(),t>=o)return this.search_results.scrollTop(t-i>0?t-i:0);if(r>n)return this.search_results.scrollTop(n)}},o.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},o.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(this.container.addClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results())},o.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this})),this.results_showing=!1},o.prototype.set_tab_index=function(){var e;return this.form_field_jq.attr("tabindex")?(e=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",e)):void 0},o.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.click(function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()}):void 0},o.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},o.prototype.search_results_mouseup=function(t){var n;return n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),n.length?(this.result_highlight=n,this.result_select(t),this.search_field.focus()):void 0},o.prototype.search_results_mouseover=function(t){var n;return n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),n?this.result_do_highlight(n):void 0},o.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},o.prototype.choice_build=function(t){var n,i,o=this;return n=e("<li />",{"class":"search-choice"}).html("<span>"+t.html+"</span>"),t.disabled?n.addClass("search-choice-disabled"):(i=e("<a />",{href:"#","class":"search-choice-close",rel:t.array_index}),i.click(function(e){return o.choice_destroy_link_click(e)}),n.append(i)),this.search_container.before(n)},o.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},o.prototype.choice_destroy=function(e){return this.result_deselect(e.attr("rel"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},o.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_option_count=null,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},o.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},o.prototype.result_select=function(e){var t,n,i,o;return this.result_highlight?(t=this.result_highlight,n=t.attr("id"),this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(this.is_multiple?t.removeClass("active-result"):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),o=n.substr(n.lastIndexOf("_")+1),i=this.results_data[o],i.selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):(this.selected_item.find("span").first().text(i.text),this.allow_single_deselect&&this.single_deselect_control_build()),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},o.prototype.result_activate=function(e,t){return e.addClass(t.disabled?"disabled-result":this.is_multiple&&t.selected?"result-selected":"active-result")},o.prototype.result_deactivate=function(e){return e.removeClass("active-result result-selected disabled-result")},o.prototype.result_deselect=function(t){var n,i;return i=this.results_data[t],this.form_field.options[i.options_index].disabled?!1:(i.selected=!1,this.form_field.options[i.options_index].selected=!1,this.selected_option_count=null,n=e("#"+this.container_id+"_o_"+t),n.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[i.options_index].value}),this.search_field_scale(),!0)},o.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chzn-single-with-deselect")):void 0},o.prototype.winnow_results=function(){var t,n,i,o,r,a,s,l,c,d,u,h,f,p,m,g,v,b;for(this.no_results_clear(),c=0,d=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),a=this.search_contains?"":"^",r=new RegExp(a+d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),f=new RegExp(d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),b=this.results_data,p=0,g=b.length;g>p;p++)if(n=b[p],!n.empty)if(n.group)e("#"+n.dom_id).css("display","none");else{if(t=!1,l=n.dom_id,s=e("#"+l),r.test(n.html))t=!0,c+=1;else if(this.enable_split_word_search&&(n.html.indexOf(" ")>=0||0===n.html.indexOf("["))&&(o=n.html.replace(/\[|\]/g,"").split(" "),o.length))for(m=0,v=o.length;v>m;m++)i=o[m],r.test(i)&&(t=!0,c+=1);t?(d.length?(u=n.html.search(f),h=n.html.substr(0,u+d.length)+"</em>"+n.html.substr(u+d.length),h=h.substr(0,u)+"<em>"+h.substr(u)):h=n.html,s.html(h),this.result_activate(s,n),null!=n.group_array_index&&e("#"+this.results_data[n.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(s))}return 1>c&&d.length?this.no_results(d):this.winnow_results_set_highlight()},o.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null==e)?void 0:this.result_do_highlight(e)},o.prototype.no_results=function(t){var n;return n=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),n.find("span").first().html(t),this.search_results.append(n)},o.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},o.prototype.keydown_arrow=function(){var e;return this.results_showing&&this.result_highlight?(e=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(e):void 0:this.results_show()},o.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},o.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},o.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},o.prototype.keydown_checker=function(e){var t,n;switch(t=null!=(n=e.which)?n:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:e.preventDefault(),this.keydown_arrow()}},o.prototype.search_field_scale=function(){var t,n,i,o,r,a,s,l;if(this.is_multiple){for(n=0,a=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",r=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],s=0,l=r.length;l>s;s++)i=r[s],o+=i+":"+this.search_field.css(i)+";";return t=e("<div />",{style:o}),t.text(this.search_field.val()),e("body").append(t),a=t.width()+25,t.remove(),this.f_width||(this.f_width=this.container.outerWidth()),a>this.f_width-10&&(a=this.f_width-10),this.search_field.css({width:a+"px"})}},o.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},o}(AbstractChosen),n.Chosen=t}.call(this),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){Array.prototype.reduce||(Array.prototype.reduce=function(e){var t,n=Object(this),i=n.length>>>0,o=0;if(2===arguments.length)t=arguments[1];else{for(;i>o&&!(o in n);)o++;if(o>=i)throw new TypeError("Reduce of empty array with no initial value");t=n[o++]}for(;i>o;o++)o in n&&(t=e(t,n[o],o,n));return t}),"function"!=typeof Array.prototype.filter&&(Array.prototype.filter=function(e){for(var t=Object(this),n=t.length>>>0,i=[],o=arguments.length>=2?arguments[1]:void 0,r=0;n>r;r++)if(r in t){var a=t[r];e.call(o,a,r,t)&&i.push(a)}return i});var t,n="function"==typeof define&&define.amd,i=function(t){var n="Comic Sans MS"===t?"Courier New":"Comic Sans MS",i=e("<div>").css({position:"absolute",left:"-9999px",top:"-9999px",fontSize:"200px"}).text("mmmmmmmmmwwwwwww").appendTo(document.body),o=i.css("fontFamily",n).width(),r=i.css("fontFamily",t+","+n).width();return i.remove(),o!==r},o={isMac:navigator.appVersion.indexOf("Mac")>-1,isMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,isFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(e.fn.jquery),isSupportAmd:n,hasCodeMirror:n?require.specified("CodeMirror"):!!window.CodeMirror,isFontInstalled:i,isW3CRangeSupport:!!document.createRange},r=function(){var t=function(e){return function(t){return e===t}},n=function(e,t){return e===t},i=function(e){return function(t,n){return t[e]===n[e]}},o=function(){return!0
},r=function(){return!1},a=function(e){return function(){return!e.apply(e,arguments)}},s=function(e,t){return function(n){return e(n)&&t(n)}},l=function(e){return e},c=0,d=function(e){var t=++c+"";return e?e+t:t},u=function(t){var n=e(document);return{top:t.top+n.scrollTop(),left:t.left+n.scrollLeft(),width:t.right-t.left,height:t.bottom-t.top}},h=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t};return{eq:t,eq2:n,peq2:i,ok:o,fail:r,self:l,not:a,and:s,uniqueId:d,rect2bnd:u,invertObject:h}}(),a=function(){var t=function(e){return e[0]},n=function(e){return e[e.length-1]},i=function(e){return e.slice(0,e.length-1)},o=function(e){return e.slice(1)},a=function(e,t){for(var n=0,i=e.length;i>n;n++){var o=e[n];if(t(o))return o}},s=function(e,t){for(var n=0,i=e.length;i>n;n++)if(!t(e[n]))return!1;return!0},l=function(t,n){return-1!==e.inArray(n,t)},c=function(e,t){return t=t||r.self,e.reduce(function(e,n){return e+t(n)},0)},d=function(e){for(var t=[],n=-1,i=e.length;++n<i;)t[n]=e[n];return t},u=function(e,i){if(!e.length)return[];var r=o(e);return r.reduce(function(e,t){var o=n(e);return i(n(o),t)?o[o.length]=t:e[e.length]=[t],e},[[t(e)]])},h=function(e){for(var t=[],n=0,i=e.length;i>n;n++)e[n]&&t.push(e[n]);return t},f=function(e){for(var t=[],n=0,i=e.length;i>n;n++)l(t,e[n])||t.push(e[n]);return t},p=function(e,t){var n=e.indexOf(t);return-1===n?null:e[n+1]},m=function(e,t){var n=e.indexOf(t);return-1===n?null:e[n-1]};return{head:t,last:n,initial:i,tail:o,prev:m,next:p,find:a,contains:l,all:s,sum:c,from:d,clusterBy:u,compact:h,unique:f}}(),s=String.fromCharCode(160),l="\ufeff",c=function(){var t=function(t){return t&&e(t).hasClass("note-editable")},n=function(t){return t&&e(t).hasClass("note-control-sizing")},i=function(t){var n;if(t.hasClass("note-air-editor")){var i=a.last(t.attr("id").split("-"));return n=function(t){return function(){return e(t+i)}},{editor:function(){return t},editable:function(){return t},popover:n("#note-popover-"),handle:n("#note-handle-"),dialog:n("#note-dialog-")}}return n=function(e){return function(){return t.find(e)}},{editor:function(){return t},dropzone:n(".note-dropzone"),toolbar:n(".note-toolbar"),editable:n(".note-editable"),codable:n(".note-codable"),statusbar:n(".note-statusbar"),popover:n(".note-popover"),handle:n(".note-handle"),dialog:n(".note-dialog")}},d=function(e){return e=e.toUpperCase(),function(t){return t&&t.nodeName.toUpperCase()===e}},u=function(e){return e&&3===e.nodeType},h=function(e){return e&&/^BR|^IMG|^HR/.test(e.nodeName.toUpperCase())},f=function(e){return t(e)?!1:e&&/^DIV|^P|^LI|^H[1-7]/.test(e.nodeName.toUpperCase())},p=d("LI"),m=function(e){return f(e)&&!p(e)},g=d("TABLE"),v=function(e){return!(C(e)||b(e)||f(e)||g(e)||y(e))},b=function(e){return e&&/^UL|^OL/.test(e.nodeName.toUpperCase())},_=function(e){return e&&/^TD|^TH/.test(e.nodeName.toUpperCase())},y=d("BLOCKQUOTE"),C=function(e){return _(e)||y(e)||t(e)},x=d("A"),w=function(e){return v(e)&&!!R(e,f)},k=function(e){return v(e)&&!R(e,f)},T=d("BODY"),S=function(e,t){return e.nextSibling===t||e.previousSibling===t},$=function(e,t){t=t||r.ok;var n=[];return e.previousSibling&&t(e.previousSibling)&&n.push(e.previousSibling),n.push(e),e.nextSibling&&t(e.nextSibling)&&n.push(e.nextSibling),n},A=o.isMSIE?"&nbsp;":"<br>",F=function(e){return u(e)?e.nodeValue.length:e.childNodes.length},N=function(e){var t=F(e);return 0===t?!0:c.isText(e)||1!==t||e.innerHTML!==A?!1:!0},E=function(e){h(e)||F(e)||(e.innerHTML=A)},R=function(e,n){for(;e;){if(n(e))return e;if(t(e))break;e=e.parentNode}return null},I=function(e,n){for(e=e.parentNode;e&&1===F(e);){if(n(e))return e;if(t(e))break;e=e.parentNode}return null},M=function(e,n){n=n||r.fail;var i=[];return R(e,function(e){return t(e)||i.push(e),n(e)}),i},L=function(e,t){var n=M(e);return a.last(n.filter(t))},D=function(t,n){for(var i=M(t),o=n;o;o=o.parentNode)if(e.inArray(o,i)>-1)return o;return null},P=function(e,t){t=t||r.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.previousSibling;return n},z=function(e,t){t=t||r.fail;for(var n=[];e&&!t(e);)n.push(e),e=e.nextSibling;return n},j=function(e,t){var n=[];return t=t||r.ok,function i(o){e!==o&&t(o)&&n.push(o);for(var r=0,a=o.childNodes.length;a>r;r++)i(o.childNodes[r])}(e),n},B=function(t,n){var i=t.parentNode,o=e("<"+n+">")[0];return i.insertBefore(o,t),o.appendChild(t),o},H=function(e,t){var n=t.nextSibling,i=t.parentNode;return n?i.insertBefore(e,n):i.appendChild(e),e},U=function(t,n){return e.each(n,function(e,n){t.appendChild(n)}),t},O=function(e){return 0===e.offset},q=function(e){return e.offset===F(e.node)},K=function(e){return O(e)||q(e)},W=function(e,t){for(;e&&e!==t;){if(0!==Q(e))return!1;e=e.parentNode}return!0},V=function(e,t){for(;e&&e!==t;){if(Q(e)!==F(e.parentNode)-1)return!1;e=e.parentNode}return!0},Q=function(e){for(var t=0;e=e.previousSibling;)t+=1;return t},G=function(e){return!!(e&&e.childNodes&&e.childNodes.length)},Y=function(e,n){var i,o;if(0===e.offset){if(t(e.node))return null;i=e.node.parentNode,o=Q(e.node)}else G(e.node)?(i=e.node.childNodes[e.offset-1],o=F(i)):(i=e.node,o=n?0:e.offset-1);return{node:i,offset:o}},J=function(e,n){var i,o;if(F(e.node)===e.offset){if(t(e.node))return null;i=e.node.parentNode,o=Q(e.node)+1}else G(e.node)?(i=e.node.childNodes[e.offset],o=0):(i=e.node,o=n?F(e.node):e.offset+1);return{node:i,offset:o}},X=function(e,t){return e.node===t.node&&e.offset===t.offset},Z=function(e){if(u(e.node)||!G(e.node)||N(e.node))return!0;var t=e.node.childNodes[e.offset-1],n=e.node.childNodes[e.offset];return t&&!h(t)||n&&!h(n)?!1:!0},et=function(e,t){for(;e;){if(t(e))return e;e=Y(e)}return null},tt=function(e,t){for(;e;){if(t(e))return e;e=J(e)}return null},nt=function(e,t,n,i){for(var o=e;o&&(n(o),!X(o,t));){var r=i&&e.node!==o.node&&t.node!==o.node;o=J(o,r)}},it=function(t,n){var i=M(n,r.eq(t));return e.map(i,Q).reverse()},ot=function(e,t){for(var n=e,i=0,o=t.length;o>i;i++)n=n.childNodes.length<=t[i]?n.childNodes[n.childNodes.length-1]:n.childNodes[t[i]];return n},rt=function(e,t){if(u(e.node))return O(e)?e.node:q(e)?e.node.nextSibling:e.node.splitText(e.offset);var n=e.node.childNodes[e.offset],i=H(e.node.cloneNode(!1),e.node);return U(i,z(n)),t||(E(e.node),E(i)),i},at=function(e,t,n){var i=M(t.node,r.eq(e));return i.length?1===i.length?rt(t,n):i.reduce(function(e,i){var o=H(i.cloneNode(!1),i);return e===t.node&&(e=rt(t,n)),U(o,z(e)),n||(E(i),E(o)),o}):null},st=function(e,t){var n,i,o=t?f:C,r=M(e.node,o),s=a.last(r)||e.node;o(s)?(n=r[r.length-2],i=s):(n=s,i=n.parentNode);var l=n&&at(n,e,t);return{rightNode:l,container:i}},lt=function(e){return document.createElement(e)},ct=function(e){return document.createTextNode(e)},dt=function(e,t){if(e&&e.parentNode){if(e.removeNode)return e.removeNode(t);var n=e.parentNode;if(!t){var i,o,r=[];for(i=0,o=e.childNodes.length;o>i;i++)r.push(e.childNodes[i]);for(i=0,o=r.length;o>i;i++)n.insertBefore(r[i],e)}n.removeChild(e)}},ut=function(e,n){for(;e&&!t(e)&&n(e);){var i=e.parentNode;dt(e),e=i}},ht=function(e,t){if(e.nodeName.toUpperCase()===t.toUpperCase())return e;var n=lt(t);return e.style.cssText&&(n.style.cssText=e.style.cssText),U(n,a.from(e.childNodes)),H(n,e),dt(e),n},ft=d("TEXTAREA"),pt=function(t,n){var i=ft(t[0])?t.val():t.html();if(n){var o=/<(\/?)(\b(?!!)[^>\s]*)(.*?)(\s*\/?>)/g;i=i.replace(o,function(e,t,n){n=n.toUpperCase();var i=/^DIV|^TD|^TH|^P|^LI|^H[1-7]/.test(n)&&!!t,o=/^BLOCKQUOTE|^TABLE|^TBODY|^TR|^HR|^UL|^OL/.test(n);return e+(i||o?"\n":"")}),i=e.trim(i)}return i},mt=function(e,t){var n=e.val();return t?n.replace(/[\n\r]/g,""):n};return{NBSP_CHAR:s,ZERO_WIDTH_NBSP_CHAR:l,blank:A,emptyPara:"<p>"+A+"</p>",makePredByNodeName:d,isEditable:t,isControlSizing:n,buildLayoutInfo:i,isText:u,isVoid:h,isPara:f,isPurePara:m,isInline:v,isBodyInline:k,isBody:T,isParaInline:w,isList:b,isTable:g,isCell:_,isBlockquote:y,isBodyContainer:C,isAnchor:x,isDiv:d("DIV"),isLi:p,isBR:d("BR"),isSpan:d("SPAN"),isB:d("B"),isU:d("U"),isS:d("S"),isI:d("I"),isImg:d("IMG"),isTextarea:ft,isEmpty:N,isEmptyAnchor:r.and(x,N),isClosestSibling:S,withClosestSiblings:$,nodeLength:F,isLeftEdgePoint:O,isRightEdgePoint:q,isEdgePoint:K,isLeftEdgeOf:W,isRightEdgeOf:V,prevPoint:Y,nextPoint:J,isSamePoint:X,isVisiblePoint:Z,prevPointUntil:et,nextPointUntil:tt,walkPoint:nt,ancestor:R,singleChildAncestor:I,listAncestor:M,lastAncestor:L,listNext:z,listPrev:P,listDescendant:j,commonAncestor:D,wrap:B,insertAfter:H,appendChildNodes:U,position:Q,hasChildren:G,makeOffsetPath:it,fromOffsetPath:ot,splitTree:at,splitPoint:st,create:lt,createText:ct,remove:dt,removeWhile:ut,replace:ht,html:pt,value:mt}}(),d=function(){var t=function(e,t){var n,i,o=e.parentElement(),r=document.body.createTextRange(),s=a.from(o.childNodes);for(n=0;n<s.length;n++)if(!c.isText(s[n])){if(r.moveToElementText(s[n]),r.compareEndPoints("StartToStart",e)>=0)break;i=s[n]}if(0!==n&&c.isText(s[n-1])){var l=document.body.createTextRange(),d=null;l.moveToElementText(i||o),l.collapse(!i),d=i?i.nextSibling:o.firstChild;var u=e.duplicate();u.setEndPoint("StartToStart",l);for(var h=u.text.replace(/[\r\n]/g,"").length;h>d.nodeValue.length&&d.nextSibling;)h-=d.nodeValue.length,d=d.nextSibling;{d.nodeValue}t&&d.nextSibling&&c.isText(d.nextSibling)&&h===d.nodeValue.length&&(h-=d.nodeValue.length,d=d.nextSibling),o=d,n=h}return{cont:o,offset:n}},n=function(e){var t=function(e,n){var i,o;if(c.isText(e)){var s=c.listPrev(e,r.not(c.isText)),l=a.last(s).previousSibling;i=l||e.parentNode,n+=a.sum(a.tail(s),c.nodeLength),o=!l}else{if(i=e.childNodes[n]||e,c.isText(i))return t(i,0);n=0,o=!1}return{node:i,collapseToStart:o,offset:n}},n=document.body.createTextRange(),i=t(e.node,e.offset);return n.moveToElementText(i.node),n.collapse(i.collapseToStart),n.moveStart("character",i.offset),n},i=function(t,s,l,d){this.sc=t,this.so=s,this.ec=l,this.eo=d;var u=function(){if(o.isW3CRangeSupport){var e=document.createRange();return e.setStart(t,s),e.setEnd(l,d),e}var i=n({node:t,offset:s});return i.setEndPoint("EndToEnd",n({node:l,offset:d})),i};this.getPoints=function(){return{sc:t,so:s,ec:l,eo:d}},this.getStartPoint=function(){return{node:t,offset:s}},this.getEndPoint=function(){return{node:l,offset:d}},this.select=function(){var e=u();if(o.isW3CRangeSupport){var t=document.getSelection();t.rangeCount>0&&t.removeAllRanges(),t.addRange(e)}else e.select()},this.normalize=function(){var e=function(e){return c.isVisiblePoint(e)||(e=c.isLeftEdgePoint(e)?c.nextPointUntil(e,c.isVisiblePoint):c.prevPointUntil(e,c.isVisiblePoint)),e},t=e(this.getStartPoint()),n=e(this.getEndPoint());return new i(t.node,t.offset,n.node,n.offset)},this.nodes=function(e,t){e=e||r.ok;var n=t&&t.includeAncestor,i=t&&t.fullyContains,o=this.getStartPoint(),s=this.getEndPoint(),l=[],d=[];return c.walkPoint(o,s,function(t){if(!c.isEditable(t.node)){var o;i?(c.isLeftEdgePoint(t)&&d.push(t.node),c.isRightEdgePoint(t)&&a.contains(d,t.node)&&(o=t.node)):o=n?c.ancestor(t.node,e):t.node,o&&e(o)&&l.push(o)}},!0),a.unique(l)},this.commonAncestor=function(){return c.commonAncestor(t,l)},this.expand=function(e){var n=c.ancestor(t,e),o=c.ancestor(l,e);if(!n&&!o)return new i(t,s,l,d);var r=this.getPoints();return n&&(r.sc=n,r.so=0),o&&(r.ec=o,r.eo=c.nodeLength(o)),new i(r.sc,r.so,r.ec,r.eo)},this.collapse=function(e){return e?new i(t,s,t,s):new i(l,d,l,d)},this.splitText=function(){var e=t===l,n=this.getPoints();return c.isText(l)&&!c.isEdgePoint(this.getEndPoint())&&l.splitText(d),c.isText(t)&&!c.isEdgePoint(this.getStartPoint())&&(n.sc=t.splitText(s),n.so=0,e&&(n.ec=n.sc,n.eo=d-s)),new i(n.sc,n.so,n.ec,n.eo)},this.deleteContents=function(){if(this.isCollapsed())return this;var t=this.splitText(),n=t.nodes(null,{fullyContains:!0}),o=c.prevPointUntil(t.getStartPoint(),function(e){return!a.contains(n,e.node)}),r=[];return e.each(n,function(e,t){var n=t.parentNode;o.node!==n&&1===c.nodeLength(n)&&r.push(n),c.remove(t,!1)}),e.each(r,function(e,t){c.remove(t,!1)}),new i(o.node,o.offset,o.node,o.offset).normalize()};var h=function(e){return function(){var n=c.ancestor(t,e);return!!n&&n===c.ancestor(l,e)}};this.isOnEditable=h(c.isEditable),this.isOnList=h(c.isList),this.isOnAnchor=h(c.isAnchor),this.isOnCell=h(c.isCell),this.isLeftEdgeOf=function(e){if(!c.isLeftEdgePoint(this.getStartPoint()))return!1;var t=c.ancestor(this.sc,e);return t&&c.isLeftEdgeOf(this.sc,t)},this.isCollapsed=function(){return t===l&&s===d},this.wrapBodyInlineWithPara=function(){if(c.isBodyContainer(t)&&c.isEmpty(t))return t.innerHTML=c.emptyPara,new i(t.firstChild,0,t.firstChild,0);if(c.isParaInline(t)||c.isPara(t))return this.normalize();var e;if(c.isInline(t)){var n=c.listAncestor(t,r.not(c.isInline));e=a.last(n),c.isInline(e)||(e=n[n.length-2]||t.childNodes[s])}else e=t.childNodes[s>0?s-1:0];var o=c.listPrev(e,c.isParaInline).reverse();if(o=o.concat(c.listNext(e.nextSibling,c.isParaInline)),o.length){var l=c.wrap(a.head(o),"p");c.appendChildNodes(l,a.tail(o))}return this.normalize()},this.insertNode=function(e){var t=this.wrapBodyInlineWithPara().deleteContents(),n=c.splitPoint(t.getStartPoint(),c.isInline(e));return n.rightNode?n.rightNode.parentNode.insertBefore(e,n.rightNode):n.container.appendChild(e),e},this.toString=function(){var e=u();return o.isW3CRangeSupport?e.toString():e.text},this.bookmark=function(e){return{s:{path:c.makeOffsetPath(e,t),offset:s},e:{path:c.makeOffsetPath(e,l),offset:d}}},this.paraBookmark=function(e){return{s:{path:a.tail(c.makeOffsetPath(a.head(e),t)),offset:s},e:{path:a.tail(c.makeOffsetPath(a.last(e),l)),offset:d}}},this.getClientRects=function(){var e=u();return e.getClientRects()}};return{create:function(e,n,r,a){if(arguments.length)2===arguments.length&&(r=e,a=n);else if(o.isW3CRangeSupport){var s=document.getSelection();if(0===s.rangeCount)return null;if(c.isBody(s.anchorNode))return null;var l=s.getRangeAt(0);e=l.startContainer,n=l.startOffset,r=l.endContainer,a=l.endOffset}else{var d=document.selection.createRange(),u=d.duplicate();u.collapse(!1);var h=d;h.collapse(!0);var f=t(h,!0),p=t(u,!1);c.isText(f.node)&&c.isLeftEdgePoint(f)&&c.isTextNode(p.node)&&c.isRightEdgePoint(p)&&p.node.nextSibling===f.node&&(f=p),e=f.cont,n=f.offset,r=p.cont,a=p.offset}return new i(e,n,r,a)},createFromNode:function(e){var t=e,n=0,i=e,o=c.nodeLength(i);return c.isVoid(t)&&(n=c.listPrev(t).length-1,t=t.parentNode),c.isBR(i)?(o=c.listPrev(i).length-1,i=i.parentNode):c.isVoid(i)&&(o=c.listPrev(i).length,i=i.parentNode),this.create(t,n,i,o)},createFromBookmark:function(e,t){var n=c.fromOffsetPath(e,t.s.path),o=t.s.offset,r=c.fromOffsetPath(e,t.e.path),a=t.e.offset;return new i(n,o,r,a)},createFromParaBookmark:function(e,t){var n=e.s.offset,o=e.e.offset,r=c.fromOffsetPath(a.head(t),e.s.path),s=c.fromOffsetPath(a.last(t),e.e.path);return new i(r,n,s,o)}}}(),u={version:"0.6.2",options:{width:null,height:null,minHeight:null,maxHeight:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,disableResizeEditor:!1,shortcuts:!0,placeholder:!1,prettifyHtml:!0,codemirror:{mode:"text/html",htmlMode:!0,lineNumbers:!0},lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","hr"]],["view",["fullscreen","codeview"]],["help",["help"]]],airMode:!1,airPopover:[["color",["color"]],["font",["bold","underline","clear"]],["para",["ul","paragraph"]],["table",["table"]],["insert",["link","picture"]]],styleTags:["p","blockquote","pre","h1","h2","h3","h4","h5","h6"],defaultFontName:"Helvetica Neue",fontNames:["Arial","Arial Black","Comic Sans MS","Courier New","Helvetica Neue","Impact","Lucida Grande","Tahoma","Times New Roman","Verdana"],fontNamesIgnoreCheck:[],colors:[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],lineHeights:["1.0","1.2","1.4","1.5","1.6","1.8","2.0","3.0"],insertTableMaxSize:{col:10,row:10},maximumImageFileSize:null,oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onMediaDelete:null,onToolbarClick:null,onsubmit:null,onCreateLink:function(e){return-1!==e.indexOf("@")&&-1===e.indexOf(":")?e="mailto:"+e:-1===e.indexOf("://")&&(e="http://"+e),e},keyMap:{pc:{ENTER:"insertParagraph","CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule","CTRL+K":"showLinkDialog"},mac:{ENTER:"insertParagraph","CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule","CMD+K":"showLinkDialog"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",clear:"Remove Font Style",height:"Line Height",name:"Font Family"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",shapeRounded:"Shape: Rounded",shapeCircle:"Shape: Circle",shapeThumbnail:"Shape: Thumbnail",shapeNone:"Shape: None",dragImageHere:"Drag image or text here",dropImage:"Drop image or Text",selectFromFiles:"Select from files",maximumFileSize:"Maximum file size",maximumFileSizeError:"Maximum file size exceeded.",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"Background Color",foreground:"Foreground Color",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style",extraKeys:"Extra keys"},history:{undo:"Undo",redo:"Redo"}}}},h=function(){var t=function(t){return e.Deferred(function(n){e.extend(new FileReader,{onload:function(e){var t=e.target.result;n.resolve(t)},onerror:function(){n.reject(this)}}).readAsDataURL(t)}).promise()},n=function(t,n){return e.Deferred(function(i){var o=e("<img>");o.one("load",function(){o.off("error abort"),i.resolve(o)}).one("error abort",function(){o.off("load").detach(),i.reject(o)}).css({display:"none"}).appendTo(document.body).attr({src:t,"data-filename":n})}).promise()};return{readFileAsDataURL:t,createImage:n}}(),f={isEdit:function(e){return a.contains([8,9,13,32],e)},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}},p=function(){var t=function(t,n){if(o.jqueryVersion<1.9){var i={};return e.each(n,function(e,n){i[n]=t.css(n)}),i}return t.css.call(t,n)};this.stylePara=function(t,n){e.each(t.nodes(c.isPara,{includeAncestor:!0}),function(t,i){e(i).css(n)})},this.styleNodes=function(t,n){t=t.splitText();var i=n&&n.nodeName||"SPAN",o=!(!n||!n.expandClosestSibling),s=!(!n||!n.onlyPartialContains);if(t.isCollapsed())return t.insertNode(c.create(i));var l=c.makePredByNodeName(i),d=e.map(t.nodes(c.isText,{fullyContains:!0}),function(e){return c.singleChildAncestor(e,l)||c.wrap(e,i)});if(o){if(s){var u=t.nodes();l=r.and(l,function(e){return a.contains(u,e)})}return e.map(d,function(t){var n=c.withClosestSiblings(t,l),i=a.head(n),o=a.tail(n);return e.each(o,function(e,t){c.appendChildNodes(i,t.childNodes),c.remove(t)}),a.head(n)})}return d},this.current=function(n,i){var o=e(c.isText(n.sc)?n.sc.parentNode:n.sc),r=["font-family","font-size","text-align","list-style-type","line-height"],a=t(o,r)||{};if(a["font-size"]=parseInt(a["font-size"],10),a["font-bold"]=document.queryCommandState("bold")?"bold":"normal",a["font-italic"]=document.queryCommandState("italic")?"italic":"normal",a["font-underline"]=document.queryCommandState("underline")?"underline":"normal",a["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",a["font-superscript"]=document.queryCommandState("superscript")?"superscript":"normal",a["font-subscript"]=document.queryCommandState("subscript")?"subscript":"normal",n.isOnList()){var s=["circle","disc","disc-leading-zero","square"],l=e.inArray(a["list-style-type"],s)>-1;a["list-style"]=l?"unordered":"ordered"}else a["list-style"]="none";var d=c.ancestor(n.sc,c.isPara);if(d&&d.style["line-height"])a["line-height"]=d.style.lineHeight;else{var u=parseInt(a["line-height"],10)/parseInt(a["font-size"],10);a["line-height"]=u.toFixed(1)}return a.image=c.isImg(i)&&i,a.anchor=n.isOnAnchor()&&c.ancestor(n.sc,c.isAnchor),a.ancestors=c.listAncestor(n.sc,c.isEditable),a.range=n,a}},m=function(){this.insertTab=function(e,t,n){var i=c.createText(new Array(n+1).join(c.NBSP_CHAR));t=t.deleteContents(),t.insertNode(i,!0),t=d.create(i,n),t.select()},this.insertParagraph=function(){var t=d.create();t=t.deleteContents(),t=t.wrapBodyInlineWithPara();var n,i=c.ancestor(t.sc,c.isPara);if(i){n=c.splitTree(i,t.getStartPoint());var o=c.listDescendant(i,c.isEmptyAnchor);o=o.concat(c.listDescendant(n,c.isEmptyAnchor)),e.each(o,function(e,t){c.remove(t)})}else{var r=t.sc.childNodes[t.so];n=e(c.emptyPara)[0],r?t.sc.insertBefore(n,r):t.sc.appendChild(n)}d.create(n,0).normalize().select()}},g=function(){this.tab=function(e,t){var n=c.ancestor(e.commonAncestor(),c.isCell),i=c.ancestor(n,c.isTable),o=c.listDescendant(i,c.isCell),r=a[t?"prev":"next"](o,n);r&&d.create(r,0).select()},this.createTable=function(t,n){for(var i,o=[],r=0;t>r;r++)o.push("<td>"+c.blank+"</td>");i=o.join("");for(var a,s=[],l=0;n>l;l++)s.push("<tr>"+i+"</tr>");return a=s.join(""),e('<table class="table table-bordered">'+a+"</table>")[0]}},v=function(){this.insertOrderedList=function(){this.toggleList("OL")},this.insertUnorderedList=function(){this.toggleList("UL")},this.indent=function(){var t=this,n=d.create().wrapBodyInlineWithPara(),i=n.nodes(c.isPara,{includeAncestor:!0}),o=a.clusterBy(i,r.peq2("parentNode"));e.each(o,function(n,i){var o=a.head(i);c.isLi(o)?t.wrapList(i,o.parentNode.nodeName):e.each(i,function(t,n){e(n).css("marginLeft",function(e,t){return(parseInt(t,10)||0)+25})})}),n.select()},this.outdent=function(){var t=this,n=d.create().wrapBodyInlineWithPara(),i=n.nodes(c.isPara,{includeAncestor:!0}),o=a.clusterBy(i,r.peq2("parentNode"));e.each(o,function(n,i){var o=a.head(i);c.isLi(o)?t.releaseList([i]):e.each(i,function(t,n){e(n).css("marginLeft",function(e,t){return t=parseInt(t,10)||0,t>25?t-25:""})})}),n.select()},this.toggleList=function(t){var n=this,i=d.create().wrapBodyInlineWithPara(),o=i.nodes(c.isPara,{includeAncestor:!0}),s=i.paraBookmark(o),l=a.clusterBy(o,r.peq2("parentNode"));if(a.find(o,c.isPurePara)){var u=[];e.each(l,function(e,i){u=u.concat(n.wrapList(i,t))}),o=u}else{var h=i.nodes(c.isList,{includeAncestor:!0}).filter(function(n){return!e.nodeName(n,t)});h.length?e.each(h,function(e,n){c.replace(n,t)}):o=this.releaseList(l,!0)}d.createFromParaBookmark(s,o).select()},this.wrapList=function(t,n){var i=a.head(t),o=a.last(t),r=c.isList(i.previousSibling)&&i.previousSibling,s=c.isList(o.nextSibling)&&o.nextSibling,l=r||c.insertAfter(c.create(n||"UL"),o);return t=e.map(t,function(e){return c.isPurePara(e)?c.replace(e,"LI"):e}),c.appendChildNodes(l,t),s&&(c.appendChildNodes(l,a.from(s.childNodes)),c.remove(s)),t},this.releaseList=function(t,n){var i=[];return e.each(t,function(t,o){var r=a.head(o),s=a.last(o),l=n?c.lastAncestor(r,c.isList):r.parentNode,d=l.childNodes.length>1?c.splitTree(l,{node:s.parentNode,offset:c.position(s)+1},!0):null,u=c.splitTree(l,{node:r.parentNode,offset:c.position(r)},!0);o=n?c.listDescendant(u,c.isLi):a.from(u.childNodes).filter(c.isLi),(n||!c.isList(l.parentNode))&&(o=e.map(o,function(e){return c.replace(e,"P")})),e.each(a.from(o).reverse(),function(e,t){c.insertAfter(t,l)});var h=a.compact([l,u,d]);e.each(h,function(t,n){var i=[n].concat(c.listDescendant(n,c.isList));e.each(i.reverse(),function(e,t){c.nodeLength(t)||c.remove(t,!0)})}),i=i.concat(o)}),i}},b=function(){var t=new p,n=new g,i=new m,r=new v;this.createRange=function(e){return e.focus(),d.create()},this.saveRange=function(e,t){e.focus(),e.data("range",d.create()),t&&d.create().collapse().select()},this.saveNode=function(e){for(var t=[],n=0,i=e[0].childNodes.length;i>n;n++)t.push(e[0].childNodes[n]);e.data("childNodes",t)},this.restoreRange=function(e){var t=e.data("range");t&&(t.select(),e.focus())},this.restoreNode=function(e){e.html("");for(var t=e.data("childNodes"),n=0,i=t.length;i>n;n++)e[0].appendChild(t[n])},this.currentStyle=function(e){var n=d.create();return n?n.isOnEditable()&&t.current(n,e):!1};var s=this.triggerOnBeforeChange=function(e){var t=e.data("callbacks").onBeforeChange;t&&t(e.html(),e)},l=this.triggerOnChange=function(e){var t=e.data("callbacks").onChange;t&&t(e.html(),e)};this.undo=function(e){s(e),e.data("NoteHistory").undo(),l(e)},this.redo=function(e){s(e),e.data("NoteHistory").redo(),l(e)};for(var u=this.beforeCommand=function(e){s(e)},f=this.afterCommand=function(e){e.data("NoteHistory").recordUndo(),l(e)},b=["bold","italic","underline","strikethrough","superscript","subscript","justifyLeft","justifyCenter","justifyRight","justifyFull","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],_=0,y=b.length;y>_;_++)this[b[_]]=function(e){return function(t,n){u(t),document.execCommand(e,!1,n),f(t)}}(b[_]);this.tab=function(e,t){var o=d.create();o.isCollapsed()&&o.isOnCell()?n.tab(o):(u(e),i.insertTab(e,o,t.tabsize),f(e))},this.untab=function(){var e=d.create();e.isCollapsed()&&e.isOnCell()&&n.tab(e,!0)},this.insertParagraph=function(e){u(e),i.insertParagraph(e),f(e)},this.insertOrderedList=function(e){u(e),r.insertOrderedList(e),f(e)},this.insertUnorderedList=function(e){u(e),r.insertUnorderedList(e),f(e)},this.indent=function(e){u(e),r.indent(e),f(e)},this.outdent=function(e){u(e),r.outdent(e),f(e)},this.insertImage=function(e,t,n){h.createImage(t,n).then(function(t){u(e),t.css({display:"",width:Math.min(e.width(),t.width())}),d.create().insertNode(t[0]),d.createFromNode(t[0]).collapse().select(),f(e)}).fail(function(){var t=e.data("callbacks");t.onImageUploadError&&t.onImageUploadError()})},this.insertNode=function(e,t){u(e);var n=this.createRange(e);n.insertNode(t),d.createFromNode(t).collapse().select(),f(e)},this.insertText=function(e,t){u(e);var n=this.createRange(e),i=n.insertNode(c.createText(t));d.create(i,c.nodeLength(i)).select(),f(e)},this.formatBlock=function(e,t){u(e),t=o.isMSIE?"<"+t+">":t,document.execCommand("FormatBlock",!1,t),f(e)},this.formatPara=function(e){u(e),this.formatBlock(e,"P"),f(e)};for(var _=1;6>=_;_++)this["formatH"+_]=function(e){return function(t){this.formatBlock(t,"H"+e)}}(_);this.fontSize=function(e,t){u(e),document.execCommand("fontSize",!1,3),o.isFF?e.find("font[size=3]").removeAttr("size").css("font-size",t+"px"):e.find("span").filter(function(){return"medium"===this.style.fontSize}).css("font-size",t+"px"),f(e)},this.lineHeight=function(e,n){u(e),t.stylePara(d.create(),{lineHeight:n}),f(e)},this.unlink=function(e){var t=d.create();if(t.isOnAnchor()){var n=c.ancestor(t.sc,c.isAnchor);t=d.createFromNode(n),t.select(),u(e),document.execCommand("unlink"),f(e)}},this.createLink=function(n,i,o){var r=i.url,s=i.text,l=i.newWindow,c=i.range,h=c.toString()!==s;u(n),o.onCreateLink&&(r=o.onCreateLink(r));var p;if(h){var m=c.insertNode(e("<A>"+s+"</A>")[0]);p=[m]}else p=t.styleNodes(c,{nodeName:"A",expandClosestSibling:!0,onlyPartialContains:!0});e.each(p,function(t,n){e(n).attr({href:r,target:l?"_blank":""})});var g=d.createFromNode(a.head(p)).collapse(!0),v=g.getStartPoint(),b=d.createFromNode(a.last(p)).collapse(),_=b.getEndPoint();d.create(v.node,v.offset,_.node,_.offset).select(),f(n)},this.getLinkInfo=function(t){t.focus();var n=d.create().expand(c.isAnchor),i=e(a.head(n.nodes(c.isAnchor)));return{range:n,text:n.toString(),isNewWindow:i.length?"_blank"===i.attr("target"):!0,url:i.length?i.attr("href"):""}},this.color=function(e,t){var n=JSON.parse(t),i=n.foreColor,o=n.backColor;u(e),i&&document.execCommand("foreColor",!1,i),o&&document.execCommand("backColor",!1,o),f(e)},this.insertTable=function(e,t){var i=t.split("x");u(e);var o=d.create();o=o.deleteContents(),o.insertNode(n.createTable(i[0],i[1])),f(e)},this.floatMe=function(e,t,n){u(e),n.css("float",t),f(e)},this.imageShape=function(e,t,n){u(e),n.removeClass("img-rounded img-circle img-thumbnail"),t&&n.addClass(t),f(e)},this.resize=function(e,t,n){u(e),n.css({width:100*t+"%",height:""}),f(e)},this.resizeTo=function(e,t,n){var i;if(n){var o=e.y/e.x,r=t.data("ratio");i={width:r>o?e.x:e.y/r,height:r>o?e.x*r:e.y}}else i={width:e.x,height:e.y};t.css(i)},this.removeMedia=function(e,t,n){u(e),n.detach();var i=e.data("callbacks");i&&i.onMediaDelete&&i.onMediaDelete(n,this,e),f(e)}},_=function(e){var t=[],n=-1,i=e[0],o=function(){var t=d.create(),n={s:{path:[0],offset:0},e:{path:[0],offset:0}};return{contents:e.html(),bookmark:t?t.bookmark(i):n}},r=function(t){null!==t.contents&&e.html(t.contents),null!==t.bookmark&&d.createFromBookmark(i,t.bookmark).select()};this.undo=function(){n>0&&(n--,r(t[n]))},this.redo=function(){t.length-1>n&&(n++,r(t[n]))},this.recordUndo=function(){n++,t.length>n&&(t=t.slice(0,n)),t.push(o())},this.recordUndo()},y=function(){this.update=function(t,n){var i=function(t,n){t.find(".dropdown-menu li a").each(function(){var t=e(this).data("value")+""==n+"";this.className=t?"checked":""})},o=function(e,n){var i=t.find(e);i.toggleClass("active",n())};if(n.image){var r=e(n.image);o('button[data-event="imageShape"][data-value="img-rounded"]',function(){return r.hasClass("img-rounded")}),o('button[data-event="imageShape"][data-value="img-circle"]',function(){return r.hasClass("img-circle")}),o('button[data-event="imageShape"][data-value="img-thumbnail"]',function(){return r.hasClass("img-thumbnail")}),o('button[data-event="imageShape"]:not([data-value])',function(){return!r.is(".img-rounded, .img-circle, .img-thumbnail")});var s=r.css("float");o('button[data-event="floatMe"][data-value="left"]',function(){return"left"===s}),o('button[data-event="floatMe"][data-value="right"]',function(){return"right"===s}),o('button[data-event="floatMe"][data-value="none"]',function(){return"left"!==s&&"right"!==s});var l=r.attr("style");return o('button[data-event="resize"][data-value="1"]',function(){return!!/(^|\s)(max-)?width\s*:\s*100%/.test(l)}),o('button[data-event="resize"][data-value="0.5"]',function(){return!!/(^|\s)(max-)?width\s*:\s*50%/.test(l)
}),void o('button[data-event="resize"][data-value="0.25"]',function(){return!!/(^|\s)(max-)?width\s*:\s*25%/.test(l)})}var c=t.find(".note-fontname");if(c.length){var d=n["font-family"];d&&(d=a.head(d.split(",")),d=d.replace(/\'/g,""),c.find(".note-current-fontname").text(d),i(c,d))}var u=t.find(".note-fontsize");u.find(".note-current-fontsize").text(n["font-size"]),i(u,parseFloat(n["font-size"]));var h=t.find(".note-height");i(h,parseFloat(n["line-height"])),o('button[data-event="bold"]',function(){return"bold"===n["font-bold"]}),o('button[data-event="italic"]',function(){return"italic"===n["font-italic"]}),o('button[data-event="underline"]',function(){return"underline"===n["font-underline"]}),o('button[data-event="strikethrough"]',function(){return"strikethrough"===n["font-strikethrough"]}),o('button[data-event="superscript"]',function(){return"superscript"===n["font-superscript"]}),o('button[data-event="subscript"]',function(){return"subscript"===n["font-subscript"]}),o('button[data-event="justifyLeft"]',function(){return"left"===n["text-align"]||"start"===n["text-align"]}),o('button[data-event="justifyCenter"]',function(){return"center"===n["text-align"]}),o('button[data-event="justifyRight"]',function(){return"right"===n["text-align"]}),o('button[data-event="justifyFull"]',function(){return"justify"===n["text-align"]}),o('button[data-event="insertUnorderedList"]',function(){return"unordered"===n["list-style"]}),o('button[data-event="insertOrderedList"]',function(){return"ordered"===n["list-style"]})},this.updateRecentColor=function(t,n,i){var o=e(t).closest(".note-color"),r=o.find(".note-recent-color"),a=JSON.parse(r.attr("data-value"));a[n]=i,r.attr("data-value",JSON.stringify(a));var s="backColor"===n?"background-color":"color";r.find("i").css(s,i)}},C=function(){var e=new y;this.update=function(t,n){e.update(t,n)},this.updateRecentColor=function(t,n,i){e.updateRecentColor(t,n,i)},this.activate=function(e){e.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(e){e.find("button").not('button[data-event="codeview"]').addClass("disabled")},this.updateFullscreen=function(e,t){var n=e.find('button[data-event="fullscreen"]');n.toggleClass("active",t)},this.updateCodeview=function(e,t){var n=e.find('button[data-event="codeview"]');n.toggleClass("active",t)}},x=function(){var t=new y,n=function(t,n){var i=e(t),o=n?i.offset():i.position(),r=i.outerHeight(!0);return{left:o.left,top:o.top+r}},i=function(e,t){e.css({display:"block",left:t.left,top:t.top})},o=20;this.update=function(s,l,c){t.update(s,l);var d=s.find(".note-link-popover");if(l.anchor){var u=d.find("a"),h=e(l.anchor).attr("href");u.attr("href",h).html(h),i(d,n(l.anchor,c))}else d.hide();var f=s.find(".note-image-popover");l.image?i(f,n(l.image,c)):f.hide();var p=s.find(".note-air-popover");if(c&&!l.range.isCollapsed()){var m=a.last(l.range.getClientRects());if(m){var g=r.rect2bnd(m);i(p,{left:Math.max(g.left+g.width/2-o,0),top:g.top+g.height})}}else p.hide()},this.updateRecentColor=function(e,t,n){e.updateRecentColor(e,t,n)},this.hide=function(e){e.children().hide()}},w=function(){this.update=function(t,n,i){var o=t.find(".note-control-selection");if(n.image){var r=e(n.image),a=i?r.offset():r.position(),s={w:r.outerWidth(!0),h:r.outerHeight(!0)};o.css({display:"block",left:a.left,top:a.top,width:s.w,height:s.h}).data("target",n.image);var l=s.w+"x"+s.h;o.find(".note-control-selection-info").text(l)}else o.hide()},this.hide=function(e){e.children().hide()}},k=function(){var t=function(e,t){e.toggleClass("disabled",!t),e.attr("disabled",!t)};this.showImageDialog=function(n,i){return e.Deferred(function(e){var n=i.find(".note-image-dialog"),o=i.find(".note-image-input"),r=i.find(".note-image-url"),a=i.find(".note-image-btn");n.one("shown.bs.modal",function(){o.replaceWith(o.clone().on("change",function(){e.resolve(this.files||this.value),n.modal("hide")}).val("")),a.click(function(t){t.preventDefault(),e.resolve(r.val()),n.modal("hide")}),r.on("keyup paste",function(e){var n;n="paste"===e.type?e.originalEvent.clipboardData.getData("text"):r.val(),t(a,n)}).val("").trigger("focus")}).one("hidden.bs.modal",function(){o.off("change"),r.off("keyup paste"),a.off("click"),"pending"===e.state()&&e.reject()}).modal("show")})},this.showLinkDialog=function(n,i,o){return e.Deferred(function(e){var n=i.find(".note-link-dialog"),r=n.find(".note-link-text"),a=n.find(".note-link-url"),s=n.find(".note-link-btn"),l=n.find("input[type=checkbox]");n.one("shown.bs.modal",function(){r.val(o.text),r.on("input",function(){o.text=r.val()}),o.url||(o.url=o.text,t(s,o.text)),a.on("input",function(){t(s,a.val()),o.text||r.val(a.val())}).val(o.url).trigger("focus").trigger("select"),l.prop("checked",o.newWindow),s.one("click",function(t){t.preventDefault(),e.resolve({range:o.range,url:a.val(),text:r.val(),newWindow:l.is(":checked")}),n.modal("hide")})}).one("hidden.bs.modal",function(){r.off("input"),a.off("input"),s.off("click"),"pending"===e.state()&&e.reject()}).modal("show")}).promise()},this.showHelpDialog=function(t,n){return e.Deferred(function(e){var t=n.find(".note-help-dialog");t.one("hidden.bs.modal",function(){e.resolve()}).modal("show")}).promise()}};o.hasCodeMirror&&(o.isSupportAmd?require(["CodeMirror"],function(e){t=e}):t=window.CodeMirror);var T=function(){var n=e(window),i=e(document),r=e("html, body"),s=new b,l=new C,d=new x,u=new w,p=new k;this.getEditor=function(){return s};var m=function(t){var n=e(t).closest(".note-editor, .note-air-editor, .note-air-layout");if(!n.length)return null;var i;return i=n.is(".note-editor, .note-air-editor")?n:e("#note-editor-"+a.last(n.attr("id").split("-"))),c.buildLayoutInfo(i)},g=function(t,n){var i=t.editor(),o=t.editable(),r=o.data("callbacks"),a=i.data("options");r.onImageUpload?r.onImageUpload(n,s,o):e.each(n,function(e,t){var n=t.name;a.maximumImageFileSize&&a.maximumImageFileSize<t.size?r.onImageUploadError?r.onImageUploadError(a.langInfo.image.maximumFileSizeError):alert(a.langInfo.image.maximumFileSizeError):h.readFileAsDataURL(t).then(function(e){s.insertImage(o,e,n)}).fail(function(){r.onImageUploadError&&r.onImageUploadError()})})},v={showLinkDialog:function(e){var t=e.editor(),n=e.dialog(),i=e.editable(),o=s.getLinkInfo(i),r=t.data("options");s.saveRange(i),p.showLinkDialog(i,n,o).then(function(t){s.restoreRange(i),s.createLink(i,t,r),d.hide(e.popover())}).fail(function(){s.restoreRange(i)})},showImageDialog:function(e){var t=e.dialog(),n=e.editable();s.saveRange(n),p.showImageDialog(n,t).then(function(t){s.restoreRange(n),"string"==typeof t?s.insertImage(n,t):g(e,t)}).fail(function(){s.restoreRange(n)})},showHelpDialog:function(e){var t=e.dialog(),n=e.editable();s.saveRange(n,!0),p.showHelpDialog(n,t).then(function(){s.restoreRange(n)})},fullscreen:function(e){var t=e.editor(),i=e.toolbar(),o=e.editable(),a=e.codable(),s=function(e){o.css("height",e.h),a.css("height",e.h),a.data("cmeditor")&&a.data("cmeditor").setsize(null,e.h)};t.toggleClass("fullscreen");var c=t.hasClass("fullscreen");c?(o.data("orgheight",o.css("height")),n.on("resize",function(){s({h:n.height()-i.outerHeight()})}).trigger("resize"),r.css("overflow","hidden")):(n.off("resize"),s({h:o.data("orgheight")}),r.css("overflow","visible")),l.updateFullscreen(i,c)},codeview:function(e){var n,i,r=e.editor(),a=e.toolbar(),s=e.editable(),h=e.codable(),f=e.popover(),p=e.handle(),m=r.data("options");r.toggleClass("codeview");var g=r.hasClass("codeview");g?(h.val(c.html(s,m.prettifyHtml)),h.height(s.height()),l.deactivate(a),d.hide(f),u.hide(p),h.focus(),o.hasCodeMirror&&(n=t.fromTextArea(h[0],m.codemirror),m.codemirror.tern&&(i=new t.TernServer(m.codemirror.tern),n.ternServer=i,n.on("cursorActivity",function(e){i.updateArgHints(e)})),n.setSize(null,s.outerHeight()),h.data("cmEditor",n))):(o.hasCodeMirror&&(n=h.data("cmEditor"),h.val(n.getValue()),n.toTextArea()),s.html(c.value(h,m.prettifyHtml)||c.emptyPara),s.height(m.height?h.height():"auto"),l.activate(a),s.focus()),l.updateCodeview(e.toolbar(),g)}},y=function(e){c.isImg(e.target)&&e.preventDefault()},T=function(e){setTimeout(function(){var t=m(e.currentTarget||e.target),n=s.currentStyle(e.target);if(n){var i=t.editor().data("options").airMode;i||l.update(t.toolbar(),n),d.update(t.popover(),n,i),u.update(t.handle(),n,i)}},0)},S=function(e){var t=m(e.currentTarget||e.target);d.hide(t.popover()),u.hide(t.handle())},$=function(t){var n=t.originalEvent.clipboardData,i=m(t.currentTarget||t.target),o=i.editable();if(!n||!n.items||!n.items.length){var r=o.data("callbacks");if(!r.onImageUpload)return;return s.saveNode(o),s.saveRange(o),o.html(""),void setTimeout(function(){var t=o.find("img");if(t.length&&-1!==t[0].src.indexOf("data:")){for(var n=t[0].src,r=atob(n.split(",")[1]),a=new Uint8Array(r.length),l=0;l<r.length;l++)a[l]=r.charCodeAt(l);var c=new Blob([a],{type:"image/png"});c.name="clipboard.png",s.restoreNode(o),s.restoreRange(o),g(i,[c]),s.afterCommand(o)}else{var d=o.html();s.restoreNode(o),s.restoreRange(o);try{e(d).each(function(){o.focus(),s.insertNode(o,this)})}catch(u){o.focus(),s.insertText(o,d)}}},0)}var l=a.head(n.items),c="file"===l.kind&&-1!==l.type.indexOf("image/");c&&g(i,[l.getAsFile()]),s.afterCommand(o)},A=function(t){if(c.isControlSizing(t.target)){t.preventDefault(),t.stopPropagation();var n=m(t.target),o=n.handle(),r=n.popover(),a=n.editable(),l=n.editor(),h=o.find(".note-control-selection").data("target"),f=e(h),p=f.offset(),g=i.scrollTop(),v=l.data("options").airMode;i.on("mousemove",function(e){s.resizeTo({x:e.clientX-p.left,y:e.clientY-(p.top-g)},f,!e.shiftKey),u.update(o,{image:h},v),d.update(r,{image:h},v)}).one("mouseup",function(){i.off("mousemove"),s.afterCommand(a)}),f.data("ratio")||f.data("ratio",f.height()/f.width())}},F=function(t){var n=e(t.target).closest("[data-event]");n.length&&t.preventDefault()},N=function(t){var n=e(t.target).closest("[data-event]");if(n.length){var i,o=n.attr("data-event"),r=n.attr("data-value"),c=n.attr("data-hide"),u=m(t.target);if(-1!==e.inArray(o,["resize","floatMe","removeMedia","imageShape"])){var h=u.handle().find(".note-control-selection");i=e(h.data("target"))}if(c&&n.parents(".popover").hide(),e.isFunction(e.summernote.pluginEvents[o]))e.summernote.pluginEvents[o](t,s,u,r);else if(s[o]){var f=u.editable();f.trigger("focus"),s[o](f,r,i),t.preventDefault()}else v[o]&&(v[o].call(this,u),t.preventDefault());if(-1!==e.inArray(o,["backColor","foreColor"])){var p=u.editor().data("options",p),g=p.airMode?d:l;g.updateRecentColor(a.head(n),o,r)}T(t)}},E=24,R=function(e){e.preventDefault(),e.stopPropagation();var t=m(e.target).editable(),n=t.offset().top-i.scrollTop(),o=m(e.currentTarget||e.target),r=o.editor().data("options");i.on("mousemove",function(e){var i=e.clientY-(n+E);i=r.minHeight>0?Math.max(i,r.minHeight):i,i=r.maxHeight>0?Math.min(i,r.maxHeight):i,t.height(i)}).one("mouseup",function(){i.off("mousemove")})},I=18,M=function(t,n){var i,o=e(t.target.parentNode),r=o.next(),a=o.find(".note-dimension-picker-mousecatcher"),s=o.find(".note-dimension-picker-highlighted"),l=o.find(".note-dimension-picker-unhighlighted");if(void 0===t.offsetX){var c=e(t.target).offset();i={x:t.pageX-c.left,y:t.pageY-c.top}}else i={x:t.offsetX,y:t.offsetY};var d={c:Math.ceil(i.x/I)||1,r:Math.ceil(i.y/I)||1};s.css({width:d.c+"em",height:d.r+"em"}),a.attr("data-value",d.c+"x"+d.r),3<d.c&&d.c<n.insertTableMaxSize.col&&l.css({width:d.c+1+"em"}),3<d.r&&d.r<n.insertTableMaxSize.row&&l.css({height:d.r+1+"em"}),r.html(d.c+" x "+d.r)},L=function(e,t){t.disableDragAndDrop?i.on("drop",function(e){e.preventDefault()}):D(e,t)},D=function(t,n){var o=e(),r=t.dropzone,a=t.dropzone.find(".note-dropzone-message");i.on("dragenter",function(e){var i=t.editor.hasClass("codeview");i||o.length||(t.editor.addClass("dragover"),r.width(t.editor.width()),r.height(t.editor.height()),a.text(n.langInfo.image.dragImageHere)),o=o.add(e.target)}).on("dragleave",function(e){o=o.not(e.target),o.length||t.editor.removeClass("dragover")}).on("drop",function(){o=e(),t.editor.removeClass("dragover")}).on("mouseout",function(e){o=o.not(e.target),o.length||t.editor.removeClass("dragover")}),r.on("dragenter",function(){r.addClass("hover"),a.text(n.langInfo.image.dropImage)}).on("dragleave",function(){r.removeClass("hover"),a.text(n.langInfo.image.dragImageHere)}),r.on("drop",function(t){t.preventDefault();var n=t.originalEvent.dataTransfer,i=n.getData("text/html"),o=n.getData("text/plain"),r=m(t.currentTarget||t.target);n&&n.files&&n.files.length?(r.editable().focus(),g(r,n.files)):i?e(i).each(function(){r.editable().focus(),s.insertNode(r.editable(),this)}):o&&(r.editable().focus(),s.insertText(r.editable(),o))}).on("dragover",!1)};this.bindKeyMap=function(t,n){var i=t.editor,o=t.editable;t=m(o),o.on("keydown",function(r){var a=[];r.metaKey&&a.push("CMD"),r.ctrlKey&&!r.altKey&&a.push("CTRL"),r.shiftKey&&a.push("SHIFT");var l=f.nameFromCode[r.keyCode];l&&a.push(l);var c=n[a.join("+")];if(c)if(e.summernote.pluginEvents[c]){var d=e.summernote.pluginEvents[c];e.isFunction(d)&&d(r,s,t)}else s[c]?(s[c](o,i.data("options")),r.preventDefault()):v[c]&&(v[c].call(this,t),r.preventDefault());else f.isEdit(r.keyCode)&&s.afterCommand(o)})},this.attach=function(e,t){t.shortcuts&&this.bindKeyMap(e,t.keyMap[o.isMac?"mac":"pc"]),e.editable.on("mousedown",y),e.editable.on("keyup mouseup",T),e.editable.on("scroll",S),e.editable.on("paste",$),e.handle.on("mousedown",A),e.popover.on("click",N),e.popover.on("mousedown",F),t.airMode||(L(e,t),e.toolbar.on("click",N),e.toolbar.on("mousedown",F),t.disableResizeEditor||e.statusbar.on("mousedown",R));var n=t.airMode?e.popover:e.toolbar,i=n.find(".note-dimension-picker-mousecatcher");i.css({width:t.insertTableMaxSize.col+"em",height:t.insertTableMaxSize.row+"em"}).on("mousemove",function(e){M(e,t)}),e.editor.data("options",t),o.isMSIE||setTimeout(function(){document.execCommand("styleWithCSS",0,t.styleWithSpan)},0);var r=new _(e.editable);if(e.editable.data("NoteHistory",r),t.onenter&&e.editable.keypress(function(e){e.keyCode===f.ENTER&&t.onenter(e)}),t.onfocus&&e.editable.focus(t.onfocus),t.onblur&&e.editable.blur(t.onblur),t.onkeyup&&e.editable.keyup(t.onkeyup),t.onkeydown&&e.editable.keydown(t.onkeydown),t.onpaste&&e.editable.on("paste",t.onpaste),t.onToolbarClick&&e.toolbar.click(t.onToolbarClick),t.onChange){var a=function(){s.triggerOnChange(e.editable)};if(o.isMSIE){var l="DOMCharacterDataModified DOMSubtreeModified DOMNodeInserted";e.editable.on(l,a)}else e.editable.on("input",a)}e.editable.data("callbacks",{onBeforeChange:t.onBeforeChange,onChange:t.onChange,onAutoSave:t.onAutoSave,onImageUpload:t.onImageUpload,onImageUploadError:t.onImageUploadError,onFileUpload:t.onFileUpload,onFileUploadError:t.onFileUpload,onMediaDelete:t.onMediaDelete})},this.detach=function(e,t){e.editable.off(),e.popover.off(),e.handle.off(),e.dialog.off(),t.airMode||(e.dropzone.off(),e.toolbar.off(),e.statusbar.off())}},S=function(){var t=function(e,t){var n=t.event,i=t.value,o=t.title,r=t.className,a=t.dropdown,s=t.hide;return'<button type="button" class="btn btn-default btn-sm btn-small'+(r?" "+r:"")+(a?" dropdown-toggle":"")+'"'+(a?' data-toggle="dropdown"':"")+(o?' title="'+o+'"':"")+(n?' data-event="'+n+'"':"")+(i?" data-value='"+i+"'":"")+(s?" data-hide='"+s+"'":"")+' tabindex="-1">'+e+(a?' <span class="caret"></span>':"")+"</button>"+(a||"")},n=function(e,n){var i='<i class="'+e+'"></i>';return t(i,n)},i=function(e,t){return'<div class="'+e+' popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content">'+t+"</div></div>"},a=function(e,t,n,i){return'<div class="'+e+' modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content">'+(t?'<div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4 class="modal-title">'+t+"</h4></div>":"")+'<form class="note-modal-form"><div class="modal-body">'+n+"</div>"+(i?'<div class="modal-footer">'+i+"</div>":"")+"</form></div></div></div>"},s={picture:function(e){return n("fa fa-picture-o",{event:"showImageDialog",title:e.image.image,hide:!0})},link:function(e){return n("fa fa-link",{event:"showLinkDialog",title:e.link.link,hide:!0})},table:function(e){var t='<ul class="note-table dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>';return n("fa fa-table",{title:e.table.table,dropdown:t})},style:function(e,t){var i=t.styleTags.reduce(function(t,n){var i=e.style["p"===n?"normal":n];return t+'<li><a data-event="formatBlock" href="#" data-value="'+n+'">'+("p"===n||"pre"===n?i:"<"+n+">"+i+"</"+n+">")+"</a></li>"},"");return n("fa fa-magic",{title:e.style.style,dropdown:'<ul class="dropdown-menu">'+i+"</ul>"})},fontname:function(e,n){var i=n.fontNames.reduce(function(e,t){return o.isFontInstalled(t)||-1!==n.fontNamesIgnoreCheck.indexOf(t)?e+'<li><a data-event="fontName" href="#" data-value="'+t+'" style="font-family:\''+t+'\'"><i class="fa fa-check"></i> '+t+"</a></li>":e},""),r='<span class="note-current-fontname">'+n.defaultFontName+"</span>";return t(r,{title:e.font.name,dropdown:'<ul class="dropdown-menu">'+i+"</ul>"})},color:function(e){var n='<i class="fa fa-font" style="color:black;background-color:yellow;"></i>',i=t(n,{className:"note-recent-color",title:e.color.recent,event:"color",value:'{"backColor":"yellow"}'}),o='<ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+e.color.background+'</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+e.color.transparent+'">'+e.color.setTransparent+'</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">'+e.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+e.color.reset+'">'+e.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>',r=t("",{title:e.color.more,dropdown:o});return i+r},bold:function(e){return n("fa fa-bold",{event:"bold",title:e.font.bold})},italic:function(e){return n("fa fa-italic",{event:"italic",title:e.font.italic})},underline:function(e){return n("fa fa-underline",{event:"underline",title:e.font.underline})},clear:function(e){return n("fa fa-eraser",{event:"removeFormat",title:e.font.clear})},ul:function(e){return n("fa fa-list-ul",{event:"insertUnorderedList",title:e.lists.unordered})},ol:function(e){return n("fa fa-list-ol",{event:"insertOrderedList",title:e.lists.ordered})},paragraph:function(e){var t=n("fa fa-align-left",{title:e.paragraph.left,event:"justifyLeft"}),i=n("fa fa-align-center",{title:e.paragraph.center,event:"justifyCenter"}),o=n("fa fa-align-right",{title:e.paragraph.right,event:"justifyRight"}),r=n("fa fa-align-justify",{title:e.paragraph.justify,event:"justifyFull"}),a=n("fa fa-outdent",{title:e.paragraph.outdent,event:"outdent"}),s=n("fa fa-indent",{title:e.paragraph.indent,event:"indent"}),l='<div class="dropdown-menu"><div class="note-align btn-group">'+t+i+o+r+'</div><div class="note-list btn-group">'+s+a+"</div></div>";return n("fa fa-align-left",{title:e.paragraph.paragraph,dropdown:l})},height:function(e,t){var i=t.lineHeights.reduce(function(e,t){return e+'<li><a data-event="lineHeight" href="#" data-value="'+parseFloat(t)+'"><i class="fa fa-check"></i> '+t+"</a></li>"},"");return n("fa fa-text-height",{title:e.font.height,dropdown:'<ul class="dropdown-menu">'+i+"</ul>"})},help:function(e){return n("fa fa-question",{event:"showHelpDialog",title:e.options.help,hide:!0})},fullscreen:function(e){return n("fa fa-arrows-alt",{event:"fullscreen",title:e.options.fullscreen})},codeview:function(e){return n("fa fa-code",{event:"codeview",title:e.options.codeview})},undo:function(e){return n("fa fa-undo",{event:"undo",title:e.history.undo})},redo:function(e){return n("fa fa-repeat",{event:"redo",title:e.history.redo})},hr:function(e){return n("fa fa-minus",{event:"insertHorizontalRule",title:e.hr.insert})}},l=function(e,o){var r=function(){var t=n("fa fa-edit",{title:e.link.edit,event:"showLinkDialog",hide:!0}),o=n("fa fa-unlink",{title:e.link.unlink,event:"unlink"}),r='<a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group">'+t+o+"</div>";return i("note-link-popover",r)},a=function(){var o=t('<span class="note-fontsize-10">100%</span>',{title:e.image.resizeFull,event:"resize",value:"1"}),r=t('<span class="note-fontsize-10">50%</span>',{title:e.image.resizeHalf,event:"resize",value:"0.5"}),a=t('<span class="note-fontsize-10">25%</span>',{title:e.image.resizeQuarter,event:"resize",value:"0.25"}),s=n("fa fa-align-left",{title:e.image.floatLeft,event:"floatMe",value:"left"}),l=n("fa fa-align-right",{title:e.image.floatRight,event:"floatMe",value:"right"}),c=n("fa fa-align-justify",{title:e.image.floatNone,event:"floatMe",value:"none"}),d=n("fa fa-square",{title:e.image.shapeRounded,event:"imageShape",value:"img-rounded"}),u=n("fa fa-circle-o",{title:e.image.shapeCircle,event:"imageShape",value:"img-circle"}),h=n("fa fa-picture-o",{title:e.image.shapeThumbnail,event:"imageShape",value:"img-thumbnail"}),f=n("fa fa-times",{title:e.image.shapeNone,event:"imageShape",value:""}),p=n("fa fa-trash-o",{title:e.image.remove,event:"removeMedia",value:"none"}),m='<div class="btn-group">'+o+r+a+'</div><div class="btn-group">'+s+l+c+'</div><div class="btn-group">'+d+u+h+f+'</div><div class="btn-group">'+p+"</div>";return i("note-image-popover",m)},l=function(){for(var t="",n=0,r=o.airPopover.length;r>n;n++){var a=o.airPopover[n];t+='<div class="note-'+a[0]+' btn-group">';for(var l=0,c=a[1].length;c>l;l++)t+=s[a[1][l]](e,o);t+="</div>"}return i("note-air-popover",t)};return'<div class="note-popover">'+r()+a()+(o.airMode?l():"")+"</div>"},d=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'},u=function(e,t){var n="note-shortcut-col col-xs-6 note-shortcut-",i=[];for(var o in t)t.hasOwnProperty(o)&&i.push('<div class="'+n+'key">'+t[o].kbd+'</div><div class="'+n+'name">'+t[o].text+"</div>");return'<div class="note-shortcut-row row"><div class="'+n+'title col-xs-offset-6">'+e+'</div></div><div class="note-shortcut-row row">'+i.join('</div><div class="note-shortcut-row row">')+"</div>"},h=function(e){var t=[{kbd:"\u2318 + B",text:e.font.bold},{kbd:"\u2318 + I",text:e.font.italic},{kbd:"\u2318 + U",text:e.font.underline},{kbd:"\u2318 + \\",text:e.font.clear}];return u(e.shortcut.textFormatting,t)},f=function(e){var t=[{kbd:"\u2318 + Z",text:e.history.undo},{kbd:"\u2318 + \u21e7 + Z",text:e.history.redo},{kbd:"\u2318 + ]",text:e.paragraph.indent},{kbd:"\u2318 + [",text:e.paragraph.outdent},{kbd:"\u2318 + ENTER",text:e.hr.insert}];return u(e.shortcut.action,t)},p=function(e){var t=[{kbd:"\u2318 + \u21e7 + L",text:e.paragraph.left},{kbd:"\u2318 + \u21e7 + E",text:e.paragraph.center},{kbd:"\u2318 + \u21e7 + R",text:e.paragraph.right},{kbd:"\u2318 + \u21e7 + J",text:e.paragraph.justify},{kbd:"\u2318 + \u21e7 + NUM7",text:e.lists.ordered},{kbd:"\u2318 + \u21e7 + NUM8",text:e.lists.unordered}];return u(e.shortcut.paragraphFormatting,t)},m=function(e){var t=[{kbd:"\u2318 + NUM0",text:e.style.normal},{kbd:"\u2318 + NUM1",text:e.style.h1},{kbd:"\u2318 + NUM2",text:e.style.h2},{kbd:"\u2318 + NUM3",text:e.style.h3},{kbd:"\u2318 + NUM4",text:e.style.h4},{kbd:"\u2318 + NUM5",text:e.style.h5},{kbd:"\u2318 + NUM6",text:e.style.h6}];return u(e.shortcut.documentStyle,t)},g=function(e,t){var n=t.extraKeys,i=[];for(var o in n)n.hasOwnProperty(o)&&i.push({kbd:o,text:n[o]});return u(e.shortcut.extraKeys,i)},v=function(e,t){var n='class="note-shortcut note-shortcut-col col-sm-6 col-xs-12"',i=["<div "+n+">"+f(e,t)+"</div><div "+n+">"+h(e,t)+"</div>","<div "+n+">"+m(e,t)+"</div><div "+n+">"+p(e,t)+"</div>"];return t.extraKeys&&i.push("<div "+n+">"+g(e,t)+"</div>"),'<div class="note-shortcut-row row">'+i.join('</div><div class="note-shortcut-row row">')+"</div>"},b=function(e){return e.replace(/\u2318/g,"Ctrl").replace(/\u21e7/g,"Shift")},_={image:function(e,t){var n="";if(t.maximumImageFileSize){var i=Math.floor(Math.log(t.maximumImageFileSize)/Math.log(1024)),o=1*(t.maximumImageFileSize/Math.pow(1024,i)).toFixed(2)+" "+" KMGTP"[i]+"B";n="<small>"+e.image.maximumFileSize+" : "+o+"</small>"}var r='<div class="form-group row-fluid note-group-select-from-files"><label>'+e.image.selectFromFiles+'</label><input class="note-image-input" type="file" name="files" accept="image/*" multiple="multiple" />'+n+'</div><div class="form-group row-fluid"><label>'+e.image.url+'</label><input class="note-image-url form-control span12" type="text" /></div>',s='<button href="#" class="btn btn-primary note-image-btn disabled" disabled>'+e.image.insert+"</button>";return a("note-image-dialog",e.image.insert,r,s)},link:function(e,t){var n='<div class="form-group row-fluid"><label>'+e.link.textToDisplay+'</label><input class="note-link-text form-control span12" type="text" /></div><div class="form-group row-fluid"><label>'+e.link.url+'</label><input class="note-link-url form-control span12" type="text" /></div>'+(t.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+e.link.openInNewWindow+"</label></div>"),i='<button href="#" class="btn btn-primary note-link-btn disabled" disabled>'+e.link.insert+"</button>";return a("note-link-dialog",e.link.insert,n,i)},help:function(e,t){var n='<a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+e.shortcut.close+'</a><div class="title">'+e.shortcut.shortcuts+"</div>"+(o.isMac?v(e,t):b(v(e,t)))+'<p class="text-center"><a href="//summernote.org/" target="_blank">Summernote 0.6.2</a> \xb7 <a href="//github.com/summernote/summernote" target="_blank">Project</a> \xb7 <a href="//github.com/summernote/summernote/issues" target="_blank">Issues</a></p>';return a("note-help-dialog","",n,"")}},y=function(t,n){var i="";return e.each(_,function(e,o){i+=o(t,n)}),'<div class="note-dialog">'+i+"</div>"},C=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'},x=function(e){return o.isMac&&(e=e.replace("CMD","\u2318").replace("SHIFT","\u21e7")),e.replace("BACKSLASH","\\").replace("SLASH","/").replace("LEFTBRACKET","[").replace("RIGHTBRACKET","]")},w=function(t,n,i){var o=r.invertObject(n),a=t.find("button");a.each(function(t,n){var i=e(n),r=o[i.data("event")];r&&i.attr("title",function(e,t){return t+" ("+x(r)+")"})}).tooltip({container:"body",trigger:"hover",placement:i||"top"}).on("click",function(){e(this).tooltip("hide")})},k=function(t,n){var i=n.colors;t.find(".note-color-palette").each(function(){for(var t=e(this),n=t.attr("data-target-event"),o=[],r=0,a=i.length;a>r;r++){for(var s=i[r],l=[],c=0,d=s.length;d>c;c++){var u=s[c];l.push(['<button type="button" class="note-color-btn" style="background-color:',u,';" data-event="',n,'" data-value="',u,'" title="',u,'" data-toggle="button" tabindex="-1"></button>'].join(""))}o.push('<div class="note-color-row">'+l.join("")+"</div>")}t.html(o.join(""))})};this.createLayoutByAirMode=function(t,n){var i=n.langInfo,a=n.keyMap[o.isMac?"mac":"pc"],s=r.uniqueId();t.addClass("note-air-editor note-editable"),t.attr({id:"note-editor-"+s,contentEditable:!0});var c=document.body,u=e(l(i,n));u.addClass("note-air-layout"),u.attr("id","note-popover-"+s),u.appendTo(c),w(u,a),k(u,n);var h=e(d());h.addClass("note-air-layout"),h.attr("id","note-handle-"+s),h.appendTo(c);var f=e(y(i,n));f.addClass("note-air-layout"),f.attr("id","note-dialog-"+s),f.find("button.close, a.modal-close").click(function(){e(this).closest(".modal").modal("hide")}),f.appendTo(c)},this.createLayoutByFrame=function(t,n){var i=n.langInfo,r=e('<div class="note-editor"></div>');n.width&&r.width(n.width),n.height>0&&e('<div class="note-statusbar">'+(n.disableResizeEditor?"":C())+"</div>").prependTo(r);var a=!t.is(":disabled"),u=e('<div class="note-editable" contentEditable="'+a+'"></div>').prependTo(r);n.height&&u.height(n.height),n.direction&&u.attr("dir",n.direction);var h=t.attr("placeholder")||n.placeholder;h&&u.attr("data-placeholder",h),u.html(c.html(t)),e('<textarea class="note-codable"></textarea>').prependTo(r);for(var f="",p=0,m=n.toolbar.length;m>p;p++){var g=n.toolbar[p][0],v=n.toolbar[p][1];f+='<div class="note-'+g+' btn-group">';for(var b=0,_=v.length;_>b;b++){var x=s[v[b]];e.isFunction(x)&&(f+=x(i,n))}f+="</div>"}f='<div class="note-toolbar btn-toolbar">'+f+"</div>";var T=e(f).prependTo(r),S=n.keyMap[o.isMac?"mac":"pc"];k(T,n),w(T,S,"bottom");var $=e(l(i,n)).prependTo(r);k($,n),w($,S),e(d()).prependTo(r);var A=e(y(i,n)).prependTo(r);A.find("button.close, a.modal-close").click(function(){e(this).closest(".modal").modal("hide")}),e('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(r),r.insertAfter(t),t.hide()},this.noteEditorFromHolder=function(t){return t.hasClass("note-air-editor")?t:t.next().hasClass("note-editor")?t.next():e()},this.createLayout=function(e,t){this.noteEditorFromHolder(e).length||(t.airMode?this.createLayoutByAirMode(e,t):this.createLayoutByFrame(e,t))},this.layoutInfoFromHolder=function(e){var t=this.noteEditorFromHolder(e);if(t.length){var n=c.buildLayoutInfo(t);for(var i in n)n.hasOwnProperty(i)&&(n[i]=n[i].call());return n}},this.removeLayout=function(e,t,n){n.airMode?(e.removeClass("note-air-editor note-editable").removeAttr("id contentEditable"),t.popover.remove(),t.handle.remove(),t.dialog.remove()):(e.html(t.editable.html()),t.editor.remove(),e.show())},this.getTemplate=function(){return{button:t,iconButton:n,dialog:a}},this.addButtonInfo=function(e,t){s[e]=t},this.addDialogInfo=function(e,t){_[e]=t}};e.summernote=e.summernote||{},e.extend(e.summernote,u);var $=new S,A=new T;e.extend(e.summernote,{renderer:$,eventHandler:A,core:{agent:o,dom:c,range:d},pluginEvents:{}}),e.summernote.addPlugin=function(t){t.buttons&&e.each(t.buttons,function(e,t){$.addButtonInfo(e,t)}),t.dialogs&&e.each(t.dialogs,function(e,t){$.addDialogInfo(e,t)}),t.events&&e.each(t.events,function(t,n){e.summernote.pluginEvents[t]=n}),t.langs&&e.each(t.langs,function(t,n){e.summernote.lang[t]&&e.extend(e.summernote.lang[t],n)}),t.options&&e.extend(e.summernote.options,t.options)},e.fn.extend({summernote:function(t){if(t=e.extend({},e.summernote.options,t),t.langInfo=e.extend(!0,{},e.summernote.lang["en-US"],e.summernote.lang[t.lang]),this.each(function(n,i){var o=e(i);$.createLayout(o,t);var r=$.layoutInfoFromHolder(o);A.attach(r,t),c.isTextarea(o[0])&&o.closest("form").submit(function(){var e=o.code();o.val(e),t.onsubmit&&t.onsubmit(e)})}),this.first().length&&t.focus){var n=$.layoutInfoFromHolder(this.first());n.editable.focus()}return this.length&&t.oninit&&t.oninit(),this},code:function(t){if(void 0===t){var n=this.first();if(!n.length)return;var i=$.layoutInfoFromHolder(n);if(i&&i.editable){var r=i.editor.hasClass("codeview");return r&&o.hasCodeMirror&&i.codable.data("cmEditor").save(),r?i.codable.val():i.editable.html()}return c.isTextarea(n[0])?n.val():n.html()}return this.each(function(n,i){var o=$.layoutInfoFromHolder(e(i));o&&o.editable&&o.editable.html(t)}),this},destroy:function(){return this.each(function(t,n){var i=e(n),o=$.layoutInfoFromHolder(i);if(o&&o.editable){var r=o.editor.data("options");A.detach(o,r),$.removeLayout(i,o,r)}}),this}})}),function(){var e;e={init:function(){return this.editBook(),this.summernoteInit(),this.selectChapter(),this.saveChapter(),this.saveAndGenerateNewChapter(),this.destroyChapter(),this.resetPassword(),this.updateUserPlan()},updateUserPlan:function(){return $(document).on("click","button.update-user",function(e){var t,n,i;return e.preventDefault(),$("html, body").css("cursor","wait"),i=$(this).data("id"),n=$("#form-primary-edit-"+i),t={tariff_type:n.find(".user-tariff-type").chosen().val(),expire_date:n.find(".user-expire-date").val()},$.ajax({type:"POST",url:"/admin/users/update_tariff",data:{id:i,user:t},dataType:"json",success:function(e){return $("html, body").css("cursor","auto"),noty({text:"Tariff for "+e.user_email+" was changed",type:"success"}),$(".md-modal.md-show .modal-header .md-close").click(),location.reload()
},error:function(){return noty({text:"Server Error",type:"error"}),$("html, body").css("cursor","auto")}})})},resetPassword:function(){return $(document).on("click",".reset-password",function(e){var t,n,i,o;return e.preventDefault(),o=$(this).data("id"),n=$("#form-primary-reset-password-"+o),i=n.find(".new-password").val(),""===i||i.length<6?(noty({text:"Password can't be empty or less then 6 symbols",type:"error"}),!1):(t={email:n.find(".user-email").val(),password:i,password:i},$("html, body").css("cursor","wait"),$.ajax({type:"POST",url:"/admin/users/reset_password",data:{id:o,user:t},dataType:"json",success:function(e){return $("html, body").css("cursor","auto"),noty({text:"Password for "+e.user_email+" was changed",type:"success"}),n.find(".new-password").val(""),$(".md-modal.md-show .modal-header .md-close").click()},error:function(){return noty({text:"Server Error",type:"error"}),$("html, body").css("cursor","auto")}}))})},editBook:function(){return $(document).on("click",".books-list .edit-book",function(e){return e.preventDefault(),window.document.location=$(this).data("href")})},summernoteInit:function(){var t;return $("textarea.ckeditor").ckeditor(),CKEDITOR.disableAutoInline=!0,$(".inline-editable").each(function(){return CKEDITOR.inline($(this)[0])}),$("#some-textarea").wysihtml5(),$('[data-provider="summernote"]').each(function(){return $(this).summernote()}),$("#summernote3").summernote(),t=$("#book-content .chapters-list li.active a.chapter").data("id"),t?e.getChapter(t):void 0},getChapter:function(e){return $("#summernote3").code(""),$(".chapter-content .chapter-title").val(""),$("html, body").css("cursor","wait"),$.ajax({type:"POST",url:"/admin/chapters/get_chapter",data:{id:e},dataType:"json",success:function(t){var n;return $("html, body").css("cursor","auto"),$("#summernote3").code(t.content),$(".chapter-content .chapter-title").val(t.title),$(".chapter-content .chapter-id").val(e),n=$('#book-content .chapters-list li a.chapter[data-id="'+e+'"]'),n.parent().hasClass("active")?void 0:n.parent().addClass("active")},error:function(){return $("html, body").css("cursor","auto")}})},selectChapter:function(){return $(document).on("click","#book-content .chapters-list li a.chapter",function(t){return t.preventDefault(),$("#book-content .chapters-list li").removeClass("active"),$(this).parent().addClass("active"),e.getChapter($(this).data("id"))})},collectDataForChapter:function(){return{title:$(".chapter-content .chapter-title").val(),content:$("#summernote3").code(),book_id:$(".chapter-content .book-id").val(),id:$(".chapter-content .chapter-id").val()}},updateChapterTemplate:function(e){return noty({text:"The chapter "+e.title+" was updated success",type:"success"}),$("html, body").css("cursor","auto"),$("#summernote3").code(e.content),$(".chapter-content .chapter-title").val(e.title),$("#book-content .chapters-list li.active a.chapter").text(e.title)},destroyChapter:function(){return $("#chapters-form").on("click","a.delete-chapter",function(t){var n,i;return t.preventDefault(),i=confirm("Are you sure?"),i?(n=$("#book-content .chapters-list li.active a.chapter"),$("html, body").css("cursor","wait"),$.ajax({type:"POST",url:"/admin/chapters/destroy_chapter",data:{chapter:{id:n.data("id")}},dataType:"json",success:function(t){return $("html, body").css("cursor","auto"),noty({text:"The chapter "+t.chapter_title+" removed success",type:"success"}),null!=t.last_chapter_id?e.getChapter(t.last_chapter_id):$(".chapter-content").hide(),n.parent().remove()},error:function(e){return noty({text:"The chapter "+e.chapter_title+" not removed success",type:"error"}),$("html, body").css("cursor","auto")}})):void 0})},saveAndGenerateNewChapter:function(){return $("#chapters-form").on("click","a.update-and-create",function(t){var n;return t.preventDefault(),n=e.collectDataForChapter(),$("html, body").css("cursor","wait"),$.ajax({type:"POST",url:"/admin/chapters/save_chapter",data:{chapter:n},dataType:"json",success:function(t){return e.updateChapterTemplate(t),setTimeout(function(){return $(".add-empty-chapter").click()},500)},error:function(e){return noty({text:"The chapter "+e.title+" not updated success",type:"error"}),$("html, body").css("cursor","auto")}})})},saveChapter:function(){return $("#chapters-form").on("click",'input[type="submit"]',function(t){var n;return t.preventDefault(),n=e.collectDataForChapter(),$("html, body").css("cursor","wait"),$.ajax({type:"POST",url:"/admin/chapters/save_chapter",data:{chapter:n},dataType:"json",success:function(t){return e.updateChapterTemplate(t)},error:function(e){return noty({text:"The chapter "+e.title+" not updated success",type:"error"}),$("html, body").css("cursor","auto")}})})}},$(function(){return e.init()})}.call(this),"function"!=typeof Object.create&&(Object.create=function(e){function t(){}return t.prototype=e,new t});var NotyObject={init:function(e){return this.options=$.extend({},$.noty.defaults,e),this.options.layout=this.options.custom?$.noty.layouts.inline:$.noty.layouts[this.options.layout],$.noty.themes[this.options.theme]?this.options.theme=$.noty.themes[this.options.theme]:e.themeClassName=this.options.theme,delete e.layout,delete e.theme,this.options=$.extend({},this.options,this.options.layout.options),this.options.id="noty_"+(new Date).getTime()*Math.floor(1e6*Math.random()),this.options=$.extend({},this.options,e),this._build(),this},_build:function(){var e=$('<div class="noty_bar noty_type_'+this.options.type+'"></div>').attr("id",this.options.id);if(e.append(this.options.template).find(".noty_text").html(this.options.text),this.$bar=null!==this.options.layout.parent.object?$(this.options.layout.parent.object).css(this.options.layout.parent.css).append(e):e,this.options.themeClassName&&this.$bar.addClass(this.options.themeClassName).addClass("noty_container_type_"+this.options.type),this.options.buttons){this.options.closeWith=[],this.options.timeout=!1;var t=$("<div/>").addClass("noty_buttons");null!==this.options.layout.parent.object?this.$bar.find(".noty_bar").append(t):this.$bar.append(t);var n=this;$.each(this.options.buttons,function(e,t){var i=$("<button/>").addClass(t.addClass?t.addClass:"gray").html(t.text).attr("id",t.id?t.id:"button-"+e).appendTo(n.$bar.find(".noty_buttons")).on("click",function(e){$.isFunction(t.onClick)&&t.onClick.call(i,n,e)})})}this.$message=this.$bar.find(".noty_message"),this.$closeButton=this.$bar.find(".noty_close"),this.$buttons=this.$bar.find(".noty_buttons"),$.noty.store[this.options.id]=this},show:function(){var e=this;return e.options.custom?e.options.custom.find(e.options.layout.container.selector).append(e.$bar):$(e.options.layout.container.selector).append(e.$bar),e.options.theme&&e.options.theme.style&&e.options.theme.style.apply(e),"function"===$.type(e.options.layout.css)?this.options.layout.css.apply(e.$bar):e.$bar.css(this.options.layout.css||{}),e.$bar.addClass(e.options.layout.addClass),e.options.layout.container.style.apply($(e.options.layout.container.selector)),e.showing=!0,e.options.theme&&e.options.theme.style&&e.options.theme.callback.onShow.apply(this),$.inArray("click",e.options.closeWith)>-1&&e.$bar.css("cursor","pointer").one("click",function(t){e.stopPropagation(t),e.options.callback.onCloseClick&&e.options.callback.onCloseClick.apply(e),e.close()}),$.inArray("hover",e.options.closeWith)>-1&&e.$bar.one("mouseenter",function(){e.close()}),$.inArray("button",e.options.closeWith)>-1&&e.$closeButton.one("click",function(t){e.stopPropagation(t),e.close()}),-1==$.inArray("button",e.options.closeWith)&&e.$closeButton.remove(),e.options.callback.onShow&&e.options.callback.onShow.apply(e),"string"==typeof e.options.animation.open?(e.$bar.css("height",e.$bar.innerHeight()),e.$bar.show().addClass(e.options.animation.open).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0})):e.$bar.animate(e.options.animation.open,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterShow&&e.options.callback.afterShow.apply(e),e.showing=!1,e.shown=!0}),e.options.timeout&&e.$bar.delay(e.options.timeout).promise().done(function(){e.close()}),this},close:function(){if(!(this.closed||this.$bar&&this.$bar.hasClass("i-am-closing-now"))){var e=this;if(this.showing)return void e.$bar.queue(function(){e.close.apply(e)});if(!this.shown&&!this.showing){var t=[];return $.each($.noty.queue,function(n,i){i.options.id!=e.options.id&&t.push(i)}),void($.noty.queue=t)}e.$bar.addClass("i-am-closing-now"),e.options.callback.onClose&&e.options.callback.onClose.apply(e),"string"==typeof e.options.animation.close?e.$bar.addClass(e.options.animation.close).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){e.options.callback.afterClose&&e.options.callback.afterClose.apply(e),e.closeCleanUp()}):e.$bar.clearQueue().stop().animate(e.options.animation.close,e.options.animation.speed,e.options.animation.easing,function(){e.options.callback.afterClose&&e.options.callback.afterClose.apply(e)}).promise().done(function(){e.closeCleanUp()})}},closeCleanUp:function(){var e=this;e.options.modal&&($.notyRenderer.setModalCount(-1),0==$.notyRenderer.getModalCount()&&$(".noty_modal").fadeOut("fast",function(){$(this).remove()})),$.notyRenderer.setLayoutCountFor(e,-1),0==$.notyRenderer.getLayoutCountFor(e)&&$(e.options.layout.container.selector).remove(),"undefined"!=typeof e.$bar&&null!==e.$bar&&("string"==typeof e.options.animation.close?(e.$bar.css("transition","all 100ms ease").css("border",0).css("margin",0).height(0),e.$bar.one("transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd",function(){e.$bar.remove(),e.$bar=null,e.closed=!0,e.options.theme.callback&&e.options.theme.callback.onClose&&e.options.theme.callback.onClose.apply(e)})):(e.$bar.remove(),e.$bar=null,e.closed=!0)),delete $.noty.store[e.options.id],e.options.theme.callback&&e.options.theme.callback.onClose&&e.options.theme.callback.onClose.apply(e),e.options.dismissQueue||($.noty.ontap=!0,$.notyRenderer.render()),e.options.maxVisible>0&&e.options.dismissQueue&&$.notyRenderer.render()},setText:function(e){return this.closed||(this.options.text=e,this.$bar.find(".noty_text").html(e)),this},setType:function(e){return this.closed||(this.options.type=e,this.options.theme.style.apply(this),this.options.theme.callback.onShow.apply(this)),this},setTimeout:function(e){if(!this.closed){var t=this;this.options.timeout=e,t.$bar.delay(t.options.timeout).promise().done(function(){t.close()})}return this},stopPropagation:function(e){e=e||window.event,"undefined"!=typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},closed:!1,showing:!1,shown:!1};$.notyRenderer={},$.notyRenderer.init=function(e){var t=Object.create(NotyObject).init(e);return t.options.killer&&$.noty.closeAll(),t.options.force?$.noty.queue.unshift(t):$.noty.queue.push(t),$.notyRenderer.render(),"object"==$.noty.returns?t:t.options.id},$.notyRenderer.render=function(){var e=$.noty.queue[0];"object"===$.type(e)?e.options.dismissQueue?e.options.maxVisible>0?$(e.options.layout.container.selector+" li").length<e.options.maxVisible&&$.notyRenderer.show($.noty.queue.shift()):$.notyRenderer.show($.noty.queue.shift()):$.noty.ontap&&($.notyRenderer.show($.noty.queue.shift()),$.noty.ontap=!1):$.noty.ontap=!0},$.notyRenderer.show=function(e){e.options.modal&&($.notyRenderer.createModalFor(e),$.notyRenderer.setModalCount(1)),e.options.custom?0==e.options.custom.find(e.options.layout.container.selector).length?e.options.custom.append($(e.options.layout.container.object).addClass("i-am-new")):e.options.custom.find(e.options.layout.container.selector).removeClass("i-am-new"):0==$(e.options.layout.container.selector).length?$("body").append($(e.options.layout.container.object).addClass("i-am-new")):$(e.options.layout.container.selector).removeClass("i-am-new"),$.notyRenderer.setLayoutCountFor(e,1),e.show()},$.notyRenderer.createModalFor=function(e){if(0==$(".noty_modal").length){var t=$("<div/>").addClass("noty_modal").addClass(e.options.theme).data("noty_modal_count",0);e.options.theme.modal&&e.options.theme.modal.css&&t.css(e.options.theme.modal.css),t.prependTo($("body")).fadeIn("fast"),$.inArray("backdrop",e.options.closeWith)>-1&&t.on("click",function(){$.noty.closeAll()})}},$.notyRenderer.getLayoutCountFor=function(e){return $(e.options.layout.container.selector).data("noty_layout_count")||0},$.notyRenderer.setLayoutCountFor=function(e,t){return $(e.options.layout.container.selector).data("noty_layout_count",$.notyRenderer.getLayoutCountFor(e)+t)},$.notyRenderer.getModalCount=function(){return $(".noty_modal").data("noty_modal_count")||0},$.notyRenderer.setModalCount=function(e){return $(".noty_modal").data("noty_modal_count",$.notyRenderer.getModalCount()+e)},$.fn.noty=function(e){return e.custom=$(this),$.notyRenderer.init(e)},$.noty={},$.noty.queue=[],$.noty.ontap=!0,$.noty.layouts={},$.noty.themes={},$.noty.returns="object",$.noty.store={},$.noty.get=function(e){return $.noty.store.hasOwnProperty(e)?$.noty.store[e]:!1},$.noty.close=function(e){return $.noty.get(e)?$.noty.get(e).close():!1},$.noty.setText=function(e,t){return $.noty.get(e)?$.noty.get(e).setText(t):!1},$.noty.setType=function(e,t){return $.noty.get(e)?$.noty.get(e).setType(t):!1},$.noty.clearQueue=function(){$.noty.queue=[]},$.noty.closeAll=function(){$.noty.clearQueue(),$.each($.noty.store,function(e,t){t.close()})};var windowAlert=window.alert;$.noty.consumeAlert=function(e){window.alert=function(t){e?e.text=t:e={text:t},$.notyRenderer.init(e)}},$.noty.stopConsumeAlert=function(){window.alert=windowAlert},$.noty.defaults={layout:"top",theme:"defaultTheme",type:"alert",text:"",dismissQueue:!0,template:'<div class="noty_message"><span class="noty_text"></span><div class="noty_close"></div></div>',animation:{open:{height:"toggle"},close:{height:"toggle"},easing:"swing",speed:500},timeout:!1,force:!1,modal:!1,maxVisible:5,killer:!1,closeWith:["click"],callback:{onShow:function(){},afterShow:function(){},onClose:function(){},afterClose:function(){},onCloseClick:function(){}},buttons:!1},$(window).on("resize",function(){$.each($.noty.layouts,function(e,t){t.container.style.apply($(t.container.selector))})}),window.noty=function(e){return jQuery.notyRenderer.init(e)},$.noty.layouts.topCenter={name:"topCenter",options:{},container:{object:'<ul id="noty_topCenter_layout_container" />',selector:"ul#noty_topCenter_layout_container",style:function(){$(this).css({top:20,left:0,position:"fixed",width:"310px",height:"auto",margin:0,padding:0,listStyleType:"none",zIndex:1e7}),$(this).css({left:($(window).width()-$(this).outerWidth(!1))/2+"px"})}},parent:{object:"<li />",selector:"li",css:{}},css:{display:"none",width:"310px"},addClass:""},$.noty.themes.defaultTheme={name:"defaultTheme",helpers:{borderFix:function(){if(this.options.dismissQueue){var e=this.options.layout.container.selector+" "+this.options.layout.parent.selector;switch(this.options.layout.name){case"top":$(e).css({borderRadius:"0px 0px 0px 0px"}),$(e).last().css({borderRadius:"0px 0px 5px 5px"});break;case"topCenter":case"topLeft":case"topRight":case"bottomCenter":case"bottomLeft":case"bottomRight":case"center":case"centerLeft":case"centerRight":case"inline":$(e).css({borderRadius:"0px 0px 0px 0px"}),$(e).first().css({"border-top-left-radius":"5px","border-top-right-radius":"5px"}),$(e).last().css({"border-bottom-left-radius":"5px","border-bottom-right-radius":"5px"});break;case"bottom":$(e).css({borderRadius:"0px 0px 0px 0px"}),$(e).first().css({borderRadius:"5px 5px 0px 0px"})}}}},modal:{css:{position:"fixed",width:"100%",height:"100%",backgroundColor:"#000",zIndex:1e4,opacity:.6,display:"none",left:0,top:0}},style:function(){switch(this.$bar.css({overflow:"hidden",background:"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABsAAAAoCAQAAAClM0ndAAAAhklEQVR4AdXO0QrCMBBE0bttkk38/w8WRERpdyjzVOc+HxhIHqJGMQcFFkpYRQotLLSw0IJ5aBdovruMYDA/kT8plF9ZKLFQcgF18hDj1SbQOMlCA4kao0iiXmah7qBWPdxpohsgVZyj7e5I9KcID+EhiDI5gxBYKLBQYKHAQoGFAoEks/YEGHYKB7hFxf0AAAAASUVORK5CYII=') repeat-x scroll left top #fff"}),this.$message.css({fontSize:"13px",lineHeight:"16px",textAlign:"center",padding:"8px 10px 9px",width:"auto",position:"relative"}),this.$closeButton.css({position:"absolute",top:4,right:4,width:10,height:10,background:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAQAAAAnOwc2AAAAxUlEQVR4AR3MPUoDURSA0e++uSkkOxC3IAOWNtaCIDaChfgXBMEZbQRByxCwk+BasgQRZLSYoLgDQbARxry8nyumPcVRKDfd0Aa8AsgDv1zp6pYd5jWOwhvebRTbzNNEw5BSsIpsj/kurQBnmk7sIFcCF5yyZPDRG6trQhujXYosaFoc+2f1MJ89uc76IND6F9BvlXUdpb6xwD2+4q3me3bysiHvtLYrUJto7PD/ve7LNHxSg/woN2kSz4txasBdhyiz3ugPGetTjm3XRokAAAAASUVORK5CYII=)",display:"none",cursor:"pointer"}),this.$buttons.css({padding:5,textAlign:"right",borderTop:"1px solid #ccc",backgroundColor:"#fff"}),this.$buttons.find("button").css({marginLeft:5}),this.$buttons.find("button:first").css({marginLeft:0}),this.$bar.on({mouseenter:function(){$(this).find(".noty_close").stop().fadeTo("normal",1)},mouseleave:function(){$(this).find(".noty_close").stop().fadeTo("normal",0)}}),this.options.layout.name){case"top":this.$bar.css({borderRadius:"0px 0px 5px 5px",borderBottom:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"});break;case"topCenter":case"center":case"bottomCenter":case"inline":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"center"});break;case"topLeft":case"topRight":case"bottomLeft":case"bottomRight":case"centerLeft":case"centerRight":this.$bar.css({borderRadius:"5px",border:"1px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"}),this.$message.css({fontSize:"13px",textAlign:"left"});break;case"bottom":this.$bar.css({borderRadius:"5px 5px 0px 0px",borderTop:"2px solid #eee",borderLeft:"2px solid #eee",borderRight:"2px solid #eee",boxShadow:"0 -2px 4px rgba(0, 0, 0, 0.1)"});break;default:this.$bar.css({border:"2px solid #eee",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.1)"})}switch(this.options.type){case"alert":case"notification":this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"});break;case"warning":this.$bar.css({backgroundColor:"#FFEAA8",borderColor:"#FFC237",color:"#826200"}),this.$buttons.css({borderTop:"1px solid #FFC237"});break;case"error":this.$bar.css({backgroundColor:"red",borderColor:"darkred",color:"#FFF"}),this.$message.css({fontWeight:"bold"}),this.$buttons.css({borderTop:"1px solid darkred"});break;case"information":this.$bar.css({backgroundColor:"#57B7E2",borderColor:"#0B90C4",color:"#FFF"}),this.$buttons.css({borderTop:"1px solid #0B90C4"});break;case"success":this.$bar.css({backgroundColor:"lightgreen",borderColor:"#50C24E",color:"darkgreen"}),this.$buttons.css({borderTop:"1px solid #50C24E"});break;default:this.$bar.css({backgroundColor:"#FFF",borderColor:"#CCC",color:"#444"})}},callback:{onShow:function(){$.noty.themes.defaultTheme.helpers.borderFix.apply(this)},onClose:function(){$.noty.themes.defaultTheme.helpers.borderFix.apply(this)}}},$.noty.defaults.timeout=8e3,$.noty.defaults.layout="topCenter",$(function(){$(".chzn-select").chosen()});